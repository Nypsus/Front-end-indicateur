{"ast":null,"code":"// src/App.js\nimport React,{useState}from'react';import{ethers}from'ethers';// Ton ABI et adresse de contrat ici\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const contractAddress='0xCd25eee89Bb01603f0E0cf8D8C243966a926761d';// Remplace cette adresse par l'adresse de ton contrat\nconst contractABI=[{\"inputs\":[{\"internalType\":\"string\",\"name\":\"productId\",\"type\":\"string\"},{\"internalType\":\"uint256\",\"name\":\"price\",\"type\":\"uint256\"}],\"name\":\"setProductPrice\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"string\",\"name\":\"productId\",\"type\":\"string\"}],\"name\":\"removeProduct\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"token\",\"type\":\"address\"},{\"internalType\":\"uint256\",\"name\":\"amount\",\"type\":\"uint256\"},{\"internalType\":\"string\",\"name\":\"productId\",\"type\":\"string\"}],\"name\":\"pay\",\"outputs\":[],\"stateMutability\":\"payable\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"owner\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"name\":\"allowedTokens\",\"outputs\":[{\"internalType\":\"bool\",\"name\":\"\",\"type\":\"bool\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"token\",\"type\":\"address\"}],\"name\":\"isTokenAllowed\",\"outputs\":[{\"internalType\":\"bool\",\"name\":\"\",\"type\":\"bool\"}],\"stateMutability\":\"view\",\"type\":\"function\"}// Ajoute d'autres éléments de l'ABI si nécessaire\n];const App=()=>{const[productId,setProductId]=useState('');const[price,setPrice]=useState('');const[loading,setLoading]=useState(false);const[errorMessage,setErrorMessage]=useState('');const[successMessage,setSuccessMessage]=useState('');// Fonction pour connecter MetaMask\nconst connectWallet=async()=>{if(!window.ethereum){alert('MetaMask est requis pour interagir avec ce contrat.');return;}await window.ethereum.request({method:'eth_requestAccounts'});setSuccessMessage('Wallet connecté avec succès!');};// Fonction pour mettre à jour un produit\nconst updateProduct=async()=>{if(!window.ethereum){alert('MetaMask est requis pour interagir avec ce contrat.');return;}if(!productId||!price){alert('Veuillez remplir l\\'ID du produit et le prix.');return;}// Initialiser le provider et signer la transaction\nconst provider=new ethers.providers.Web3Provider(window.ethereum);const signer=provider.getSigner();const contract=new ethers.Contract(contractAddress,contractABI,signer);try{setLoading(true);setErrorMessage('');setSuccessMessage('');// Convertir le prix en wei (ou utiliser parseUnits si en USDT)\nconst priceInWei=ethers.utils.parseUnits(price,18);// Assurez-vous que '18' est correct pour l'unité (par exemple USDT)\n// Appel de la fonction pour mettre à jour le prix du produit\nconst tx=await contract.setProductPrice(productId,priceInWei);await tx.wait();// Attendre que la transaction soit confirmée\nsetSuccessMessage('Le produit a été mis à jour avec succès !');}catch(error){setErrorMessage('Erreur lors de la mise à jour du produit : '+error.message);}finally{setLoading(false);}};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Mettre \\xE0 jour un produit\"}),/*#__PURE__*/_jsx(\"button\",{onClick:connectWallet,children:\"Connecter le portefeuille MetaMask\"}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"ID du produit\",value:productId,onChange:e=>setProductId(e.target.value)})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"input\",{type:\"number\",placeholder:\"Prix du produit (en USDT)\",value:price,onChange:e=>setPrice(e.target.value)})}),/*#__PURE__*/_jsx(\"button\",{onClick:updateProduct,disabled:loading,children:loading?'Mise à jour...':'Mettre à jour le produit'}),errorMessage&&/*#__PURE__*/_jsx(\"div\",{style:{color:'red'},children:errorMessage}),successMessage&&/*#__PURE__*/_jsx(\"div\",{style:{color:'green'},children:successMessage})]});};export default App;","map":{"version":3,"names":["React","useState","ethers","jsx","_jsx","jsxs","_jsxs","contractAddress","contractABI","App","productId","setProductId","price","setPrice","loading","setLoading","errorMessage","setErrorMessage","successMessage","setSuccessMessage","connectWallet","window","ethereum","alert","request","method","updateProduct","provider","providers","Web3Provider","signer","getSigner","contract","Contract","priceInWei","utils","parseUnits","tx","setProductPrice","wait","error","message","children","onClick","type","placeholder","value","onChange","e","target","disabled","style","color"],"sources":["/home/nypsus/mon-projet-deploiement/Front-end-indicateur/src/App.js"],"sourcesContent":["// src/App.js\nimport React, { useState } from 'react';\nimport { ethers } from 'ethers';\n\n// Ton ABI et adresse de contrat ici\nconst contractAddress = '0xCd25eee89Bb01603f0E0cf8D8C243966a926761d'; // Remplace cette adresse par l'adresse de ton contrat\nconst contractABI = [\n  {\n    \"inputs\": [\n      {\n        \"internalType\": \"string\",\n        \"name\": \"productId\",\n        \"type\": \"string\"\n      },\n      {\n        \"internalType\": \"uint256\",\n        \"name\": \"price\",\n        \"type\": \"uint256\"\n      }\n    ],\n    \"name\": \"setProductPrice\",\n    \"outputs\": [],\n    \"stateMutability\": \"nonpayable\",\n    \"type\": \"function\"\n  },\n  {\n    \"inputs\": [\n      {\n        \"internalType\": \"string\",\n        \"name\": \"productId\",\n        \"type\": \"string\"\n      }\n    ],\n    \"name\": \"removeProduct\",\n    \"outputs\": [],\n    \"stateMutability\": \"nonpayable\",\n    \"type\": \"function\"\n  },\n  {\n    \"inputs\": [\n      {\n        \"internalType\": \"address\",\n        \"name\": \"token\",\n        \"type\": \"address\"\n      },\n      {\n        \"internalType\": \"uint256\",\n        \"name\": \"amount\",\n        \"type\": \"uint256\"\n      },\n      {\n        \"internalType\": \"string\",\n        \"name\": \"productId\",\n        \"type\": \"string\"\n      }\n    ],\n    \"name\": \"pay\",\n    \"outputs\": [],\n    \"stateMutability\": \"payable\",\n    \"type\": \"function\"\n  },\n  {\n    \"inputs\": [],\n    \"name\": \"owner\",\n    \"outputs\": [\n      {\n        \"internalType\": \"address\",\n        \"name\": \"\",\n        \"type\": \"address\"\n      }\n    ],\n    \"stateMutability\": \"view\",\n    \"type\": \"function\"\n  },\n  {\n    \"inputs\": [\n      {\n        \"internalType\": \"address\",\n        \"name\": \"\",\n        \"type\": \"address\"\n      }\n    ],\n    \"name\": \"allowedTokens\",\n    \"outputs\": [\n      {\n        \"internalType\": \"bool\",\n        \"name\": \"\",\n        \"type\": \"bool\"\n      }\n    ],\n    \"stateMutability\": \"view\",\n    \"type\": \"function\"\n  },\n  {\n    \"inputs\": [\n      {\n        \"internalType\": \"address\",\n        \"name\": \"token\",\n        \"type\": \"address\"\n      }\n    ],\n    \"name\": \"isTokenAllowed\",\n    \"outputs\": [\n      {\n        \"internalType\": \"bool\",\n        \"name\": \"\",\n        \"type\": \"bool\"\n      }\n    ],\n    \"stateMutability\": \"view\",\n    \"type\": \"function\"\n  }\n  // Ajoute d'autres éléments de l'ABI si nécessaire\n];\n\nconst App = () => {\n  const [productId, setProductId] = useState('');\n  const [price, setPrice] = useState('');\n  const [loading, setLoading] = useState(false);\n  const [errorMessage, setErrorMessage] = useState('');\n  const [successMessage, setSuccessMessage] = useState('');\n\n  // Fonction pour connecter MetaMask\n  const connectWallet = async () => {\n    if (!window.ethereum) {\n      alert('MetaMask est requis pour interagir avec ce contrat.');\n      return;\n    }\n    await window.ethereum.request({ method: 'eth_requestAccounts' });\n    setSuccessMessage('Wallet connecté avec succès!');\n  };\n\n  // Fonction pour mettre à jour un produit\n  const updateProduct = async () => {\n    if (!window.ethereum) {\n      alert('MetaMask est requis pour interagir avec ce contrat.');\n      return;\n    }\n    if (!productId || !price) {\n      alert('Veuillez remplir l\\'ID du produit et le prix.');\n      return;\n    }\n\n    // Initialiser le provider et signer la transaction\n    const provider = new ethers.providers.Web3Provider(window.ethereum);\n    const signer = provider.getSigner();\n    const contract = new ethers.Contract(contractAddress, contractABI, signer);\n\n    try {\n      setLoading(true);\n      setErrorMessage('');\n      setSuccessMessage('');\n\n      // Convertir le prix en wei (ou utiliser parseUnits si en USDT)\n      const priceInWei = ethers.utils.parseUnits(price, 18);  // Assurez-vous que '18' est correct pour l'unité (par exemple USDT)\n\n      // Appel de la fonction pour mettre à jour le prix du produit\n      const tx = await contract.setProductPrice(productId, priceInWei);\n      await tx.wait(); // Attendre que la transaction soit confirmée\n\n      setSuccessMessage('Le produit a été mis à jour avec succès !');\n    } catch (error) {\n      setErrorMessage('Erreur lors de la mise à jour du produit : ' + error.message);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div>\n      <h1>Mettre à jour un produit</h1>\n      <button onClick={connectWallet}>Connecter le portefeuille MetaMask</button>\n\n      <div>\n        <input\n          type=\"text\"\n          placeholder=\"ID du produit\"\n          value={productId}\n          onChange={(e) => setProductId(e.target.value)}\n        />\n      </div>\n\n      <div>\n        <input\n          type=\"number\"\n          placeholder=\"Prix du produit (en USDT)\"\n          value={price}\n          onChange={(e) => setPrice(e.target.value)}\n        />\n      </div>\n\n      <button onClick={updateProduct} disabled={loading}>\n        {loading ? 'Mise à jour...' : 'Mettre à jour le produit'}\n      </button>\n\n      {errorMessage && <div style={{ color: 'red' }}>{errorMessage}</div>}\n      {successMessage && <div style={{ color: 'green' }}>{successMessage}</div>}\n    </div>\n  );\n};\n\nexport default App;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}