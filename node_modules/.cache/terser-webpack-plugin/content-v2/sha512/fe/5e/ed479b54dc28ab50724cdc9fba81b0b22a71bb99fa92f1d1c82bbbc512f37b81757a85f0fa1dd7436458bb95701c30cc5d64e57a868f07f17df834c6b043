{"code":"(this[\"webpackJsonpFront-end-indicateur\"]=this[\"webpackJsonpFront-end-indicateur\"]||[]).push([[0],{186:function(e,t,n){},187:function(e,t,n){},211:function(e,t){},247:function(e,t){},249:function(e,t){},257:function(e,t){},304:function(e,t){},305:function(e,t){},332:function(e,t){},334:function(e,t){},442:function(e,t){},443:function(e,t){},446:function(e,t,n){\"use strict\";n.r(t);var r=n(10),a=n.n(r),i=n(189),o=n.n(i),s=n(190),c=n.n(s),l=n(22),u=n(449),d=n(112),p=(n(12),n(186),n(187),n(8));const y=\"0x55d398326f99059fF775485246999027B3197955\",f=[\"function balanceOf(address) view returns (uint256)\",\"function allowance(address, address) view returns (uint256)\",\"function approve(address spender, uint256 amount) public returns (bool)\",\"function transferFrom(address sender, address recipient, uint256 amount) public returns (bool)\"],w=\"0xCd25eee89Bb01603f0E0cf8D8C243966a926761d\";new l.a.providers.JsonRpcProvider(\"https://bsc-dataseed.binance.org/\");var v=function(){const[e,t]=Object(r.useState)(null),[n,a]=Object(r.useState)(null),[i,o]=Object(r.useState)(!1),[s,v]=Object(r.useState)(\"\"),[m,b]=Object(r.useState)(null),[h,g]=Object(r.useState)(\"product1\"),[j,x]=Object(r.useState)({product1:{price:5,exists:!0,title:\"Indicateur Daily\"},product2:{price:295,exists:!0,title:\"Indicateur 4h/1h\"},product3:{price:495,exists:!0,title:\"Indicateur 15mn\"}}),[S,T]=Object(r.useState)(\"\"),[O,B]=Object(r.useState)(null),[D,k]=Object(r.useState)(null),[M,P]=Object(r.useState)(\"USD\"),[E,U]=Object(r.useState)(null),[A,I]=Object(r.useState)(null);Object(r.useEffect)((()=>{const e=new c.a({cacheProvider:!0,providerOptions:{walletconnect:{package:d.a,options:{infuraId:\"e759bc5af90042a1b66c5a01aae905af\"}},metamask:{package:null},trustwallet:{package:d.a,options:{infuraId:\"pDtEhrK4AAiPfirK7qsQI25NJlgrtMu1bBcFDqV4J95GTCAR2d/8Lg\"}}}});t(e);const n=setInterval((()=>{const e=document.querySelector(\".web3-modal-container\");e&&(e.style.zIndex=\"999999\",clearInterval(n))}),100);return()=>clearInterval(n)}),[]),(()=>{const e=document.querySelector(\"iframe\");e&&(e.style.display=\"none\")})(),Object(r.useEffect)((()=>{(async()=>{if(n){const t=\"0xD62B5CFdDfd26F6219E4BF366d9DB6B1450D5905\",r=[{inputs:[{internalType:\"address\",name:\"token\",type:\"address\"}],name:\"addAllowedToken\",outputs:[],stateMutability:\"nonpayable\",type:\"function\"},{inputs:[{internalType:\"address\",name:\"token\",type:\"address\"},{internalType:\"uint256\",name:\"amount\",type:\"uint256\"},{internalType:\"string\",name:\"productId\",type:\"string\"}],name:\"pay\",outputs:[],stateMutability:\"payable\",type:\"function\"},{inputs:[{internalType:\"address\",name:\"token\",type:\"address\"}],name:\"removeAllowedToken\",outputs:[],stateMutability:\"nonpayable\",type:\"function\"},{inputs:[{internalType:\"address[]\",name:\"tokens\",type:\"address[]\"}],stateMutability:\"nonpayable\",type:\"constructor\"},{anonymous:!1,inputs:[{indexed:!0,internalType:\"address\",name:\"user\",type:\"address\"},{indexed:!1,internalType:\"uint256\",name:\"amount\",type:\"uint256\"},{indexed:!1,internalType:\"address\",name:\"token\",type:\"address\"},{indexed:!1,internalType:\"string\",name:\"productId\",type:\"string\"}],name:\"PaymentReceived\",type:\"event\"},{inputs:[{internalType:\"string\",name:\"productId\",type:\"string\"}],name:\"removeProduct\",outputs:[],stateMutability:\"nonpayable\",type:\"function\"},{inputs:[{internalType:\"string\",name:\"productId\",type:\"string\"},{internalType:\"uint256\",name:\"price\",type:\"uint256\"}],name:\"setProductPrice\",outputs:[],stateMutability:\"nonpayable\",type:\"function\"},{inputs:[{internalType:\"uint256\",name:\"amount\",type:\"uint256\"}],name:\"withdraw\",outputs:[],stateMutability:\"nonpayable\",type:\"function\"},{inputs:[{internalType:\"address\",name:\"token\",type:\"address\"},{internalType:\"uint256\",name:\"amount\",type:\"uint256\"}],name:\"withdrawToken\",outputs:[],stateMutability:\"nonpayable\",type:\"function\"},{inputs:[{internalType:\"address\",name:\"\",type:\"address\"}],name:\"allowedTokens\",outputs:[{internalType:\"bool\",name:\"\",type:\"bool\"}],stateMutability:\"view\",type:\"function\"},{inputs:[{internalType:\"address\",name:\"token\",type:\"address\"}],name:\"isTokenAllowed\",outputs:[{internalType:\"bool\",name:\"\",type:\"bool\"}],stateMutability:\"view\",type:\"function\"},{inputs:[],name:\"owner\",outputs:[{internalType:\"address\",name:\"\",type:\"address\"}],stateMutability:\"view\",type:\"function\"},{inputs:[{internalType:\"string\",name:\"\",type:\"string\"}],name:\"products\",outputs:[{internalType:\"uint256\",name:\"price\",type:\"uint256\"},{internalType:\"bool\",name:\"exists\",type:\"bool\"}],stateMutability:\"view\",type:\"function\"}],a=new l.a.Contract(t,r,n.getSigner());try{const e=await a.products(\"product1\");x(e),B(e.price)}catch(e){console.error(\"Erreur lors de la r\\xe9cup\\xe9ration des informations du produit:\",e)}I(a)}})(),(async()=>{try{const e=await u.a.get(\"https://api.coingecko.com/api/v3/simple/price?ids=binancecoin&vs_currencies=usd\");k(e.data.binancecoin.usd)}catch(e){console.error(\"Erreur lors de la r\\xe9cup\\xe9ration du taux BNB -> USD\",e)}})()}),[n]);const C=async e=>{const t=n.getSigner(),r=new l.a.Contract(y,f,t);try{const n=await r.allowance(await t.getAddress(),w);if(console.log(\"Allowance actuelle:\",n.toString()),n.lt(e)){console.log(\"Allowance insuffisante, approbation en cours...\");const t=await r.approve(w,e);if(1!==(await t.wait()).status)throw console.error(\"L'approbation de l'allowance a \\xe9chou\\xe9.\"),new Error(\"\\xc9chec de l'approbation de l'allowance.\");console.log(\"Allowance mise \\xe0 jour !\")}else console.log(\"Allowance suffisante.\")}catch(a){console.error(\"Erreur lors de l'approbation de l'allowance USDT :\",a)}},[N,F]=Object(r.useState)(!1),[L,z]=Object(r.useState)(!1),q=e=>{const t={product1:{price:5,exists:!0,title:\"Indicateur Daily\"},product2:{price:295,exists:!0,title:\"Indicateur 4h/1h\"},product3:{price:495,exists:!0,title:\"Indicateur 15mn\"}}[e];return t?t.price:null},V=async()=>{try{if(\"undefined\"!==typeof window.ethereum){const e=new l.a.providers.Web3Provider(window.ethereum);return a(e),e.getSigner()}throw new Error(\"Aucun fournisseur Ethereum n'est disponible.\")}catch(e){return console.error(\"Erreur dans resetProvider:\",e),alert(\"Erreur lors de la r\\xe9initialisation du provider.\"),null}};Object(r.useEffect)((()=>{const e=async()=>{try{await V(),console.log(\"Le provider a \\xe9t\\xe9 r\\xe9initialis\\xe9 apr\\xe8s le changement de r\\xe9seau.\")}catch(e){console.error(\"Erreur lors du changement de r\\xe9seau et r\\xe9initialisation du provider:\",e)}};return\"undefined\"!==typeof window.ethereum&&window.ethereum.on(\"chainChanged\",e),()=>{\"undefined\"!==typeof window.ethereum&&window.ethereum.removeListener(\"chainChanged\",e)}}),[]);const W=Object(r.useCallback)((e=>{T(e);const t=j[e];if(t&&t.exists&&t.price>0){const n=t.price;B(n),x((r=>({...r,[e]:{...t,price:n}}))),\"USDT\"===M?U(n.toString()):\"BNB\"===M&&D>0&&U((n/D).toString())}else console.error(\"Produit invalide ou prix incorrect.\"),alert(\"Produit invalide ou prix incorrect.\")}),[M,D]);return Object(r.useEffect)((()=>{if(S&&j[S]){const e=j[S].price;\"USDT\"===M?U(e.toString()):\"BNB\"===M&&D>0&&U((e/D).toString())}}),[M,S,D]),Object(p.jsx)(\"div\",{className:\"App\",children:Object(p.jsxs)(\"div\",{className:\"parallax-container\",children:[Object(p.jsxs)(\"video\",{id:\"video-background\",autoPlay:!0,loop:!0,muted:!0,children:[Object(p.jsx)(\"source\",{src:\"https://gateway.pinata.cloud/ipfs/QmPZ8v3KzeyH2Dqz29TZFWe4kswkUETJyesZFCFULtagwv\",type:\"video/mp4\"}),\"Votre navigateur ne supporte pas les vid\\xe9os HTML5.\"]}),Object(p.jsxs)(\"div\",{className:\"content\",children:[Object(p.jsx)(\"div\",{className:\"wallet-connect-button\",children:Object(p.jsx)(\"button\",{onClick:async()=>{if(e)try{console.log(\"Tentative de connexion au wallet...\");const t=await e.connect(),n=new l.a.providers.Web3Provider(t);if(!n)return void console.error(\"Le fournisseur Web3 n'a pas \\xe9t\\xe9 correctement cr\\xe9\\xe9\");a(n);const r=n.getSigner(),i=await r.getAddress();v(i),o(!0),console.log(`Wallet connect\\xe9: ${i}`)}catch(t){console.error(\"Erreur lors de la connexion au portefeuille:\",t),alert(\"Erreur de connexion au portefeuille. Veuillez connecter votre wallet.\"),e.clearCachedProvider();try{\"undefined\"!==typeof window.ethereum?await(async()=>{if(\"undefined\"!==typeof window.ethereum)try{await window.ethereum.request({method:\"wallet_requestPermissions\",params:[{eth_accounts:{}}]}),setTimeout((async()=>{await window.ethereum.request({method:\"eth_requestAccounts\"});const e=new l.a.providers.Web3Provider(window.ethereum).getSigner(),t=await e.getAddress();v(t),o(!0),alert(`Compte connect\\xe9 : ${t}`)}),1e3)}catch(t){console.error(\"Erreur de connexion \\xe0 MetaMask :\",t),alert(\"\\xc9chec de la connexion \\xe0 MetaMask.\")}else alert(\"MetaMask n'est pas install\\xe9 !\")})():alert(\"MetaMask n'est pas install\\xe9.\")}catch(n){console.error(\"\\xc9chec de la reconnexion \\xe0 MetaMask\",n),alert(\"La reconnexion \\xe0 MetaMask a \\xe9chou\\xe9.\")}}else console.error(\"Web3Modal non initialis\\xe9\")},disabled:i,children:i?Object(p.jsxs)(p.Fragment,{children:[Object(p.jsxs)(\"span\",{children:[\"Wallet connect\\xe9 : \",s]}),Object(p.jsx)(\"span\",{className:\"arrow-icon\",children:\"\\u2192\"}),\" \"]}):\"Connecter le wallet\"})}),Object(p.jsxs)(\"div\",{className:\"payment-wrapper\",children:[Object(p.jsx)(\"h1\",{children:\" Les Indicateurs \\xe0 Levier \"}),S&&j[S]?Object(p.jsxs)(p.Fragment,{children:[Object(p.jsxs)(\"p\",{children:[\"Produit choisi : \",j[S].title]}),Object(p.jsxs)(\"p\",{children:[\"Prix du produit : \",null!==E?E.toFixed(2):\"Chargement...\",\" \",M]}),Object(p.jsxs)(\"p\",{children:[\"Le produit est \",j[S].exists?\"disponible\":\"indisponible\"]})]}):Object(p.jsx)(\"p\",{children:\"Veuillez choisir un produit.\"}),Object(p.jsxs)(\"select\",{onChange:e=>W(e.target.value),value:S,children:[Object(p.jsx)(\"option\",{value:\"\",children:\"Choisi Ton Indicateur\"}),Object(p.jsx)(\"option\",{value:\"product1\",children:\"Indicateur Daily\"}),Object(p.jsx)(\"option\",{value:\"product2\",children:\"Indicateur 4h/1h\"}),Object(p.jsx)(\"option\",{value:\"product3\",children:\"Indicateur 15mn\"})]}),Object(p.jsxs)(\"select\",{onChange:e=>{if(P(e.target.value),S&&j[S]){const t=j[S].price;\"USDT\"===e.target.value?U(t.toString()):\"BNB\"===e.target.value&&D>0&&U((t/D).toString())}},value:M,children:[Object(p.jsx)(\"option\",{value:\"USDT\",children:\"USD\"}),Object(p.jsx)(\"option\",{value:\"BNB\",children:\"BNB\"})]}),Object(p.jsx)(\"button\",{onClick:async()=>{if(N||L)return void console.log(\"Transaction d\\xe9j\\xe0 en cours, veuillez patienter.\");if(z(!0),F(!0),null===E||parseFloat(E)<=0)return alert(\"Prix invalide ou non d\\xe9fini pour le produit.\"),F(!1),void z(!1);if(!i)return alert(\"Veuillez connecter votre wallet avant de proc\\xe9der.\"),F(!1),void z(!1);if(!A)return console.error(\"Le contrat n'est pas initialis\\xe9.\"),F(!1),void z(!1);if(!S||!j[S])return alert(\"Veuillez s\\xe9lectionner un produit valide et essayer de nouveau.\"),F(!1),void z(!1);if(!await(async()=>{if(\"undefined\"!==typeof window.ethereum)return\"0x38\"===await window.ethereum.request({method:\"eth_chainId\"})||(alert(\"Veuillez vous connecter au r\\xe9seau Binance Smart Chain Mainnet.\"),!1);return console.error(\"Ethereum n'est pas disponible.\"),alert(\"MetaMask ou un autre portefeuille Ethereum n'est pas install\\xe9.\"),!1})())return F(!1),void z(!1);if(!n)return alert(\"Reconnexion au provider effectu\\xe9e. Veuillez renouveler l'op\\xe9ration.\"),await V(),F(!1),void z(!1);let e=await q(S);if(e<=0)return alert(\"Le prix du produit est invalide.\"),F(!1),void z(!1);console.log(\"Prix du produit en USD r\\xe9cup\\xe9r\\xe9 dans handlePayment:\",e);const t=await(async()=>{try{const e=(await u.a.get(\"https://api.coingecko.com/api/v3/simple/price?ids=binancecoin&vs_currencies=usd\")).data.binancecoin.usd;if(e<=0)throw new Error(\"Le taux de conversion BNB/USD est invalide.\");return e}catch(e){return console.error(\"Erreur lors de la r\\xe9cup\\xe9ration du taux de conversion BNB/USD :\",e),0}})();if(t<=0)return alert(\"Erreur de r\\xe9cup\\xe9ration du taux de conversion BNB/USD.\"),F(!1),void z(!1);const r=j[S];if(!r||!r.exists||r.price<=0)return alert(\"Produit invalide ou prix incorrect.\"),F(!1),void z(!1);let a=0;try{if(a=e,\"USDT\"===M)a=e;else{if(\"BNB\"!==M)return alert(\"Devise non support\\xe9e pour ce paiement.\"),F(!1),void z(!1);a=e/t}if(console.log(\"Prix du produit en USD:\",e),console.log(\"Taux de conversion BNB/USD:\",t),console.log(\"Montant en BNB \\xe0 envoyer:\",a),parseFloat(a)<=0)return alert(\"Le montant \\xe0 payer est invalide (0 ou n\\xe9gatif).\"),F(!1),void z(!1);a=parseFloat(a).toFixed(18),console.log(\"Montant final pour la transaction:\",a),await(async e=>{if(A)try{const t=new l.a.Contract(y,f,n.getSigner()),r=await t.allowance(s,w);console.log(\"Allowance:\",r.toString()),r.lt(e)&&(console.log(\"Allowance insuffisante. Approbation automatique...\"),await C(e))}catch(t){console.error(\"Erreur lors de la v\\xe9rification de l'allowance:\",t)}})(a),await(async(e,t)=>{if(A)try{const n=q(e);if(null===n)return console.error(\"Produit non trouv\\xe9 ou prix invalide\"),void alert(\"Le prix du produit est invalide.\");console.log(\"Prix du produit r\\xe9cup\\xe9r\\xe9:\",n);const r=await A.pay(y,t,e,{gasLimit:2e5});await r.wait(),console.log(\"Paiement effectu\\xe9 avec succ\\xe8s !\")}catch(n){console.error(\"Erreur lors du paiement:\",n),alert(\"Une erreur s'est produite lors du paiement.\")}})(S,a),await(async(e,t)=>{if(n)try{const r=n.getSigner(),a=\"USDT\"===M?l.a.utils.parseUnits(e.toString(),6):l.a.utils.parseUnits(e.toString(),18),i=5e4,o=(await n.getGasPrice()).mul(110).div(100);console.log(\"GasPrice ajust\\xe9 : \",o.toString());const s=await n.getBalance(r.getAddress());if(\"BNB\"===M&&s.lt(a.add(o)))return void alert(\"Solde insuffisant pour couvrir la transaction et les frais de gaz en BNB.\");if(\"USDT\"===M){const e=new l.a.Contract(y,f,r);if((await e.balanceOf(r.getAddress())).lt(a))return void alert(\"Solde insuffisant en USDT pour couvrir la transaction.\");(await e.allowance(r.getAddress(),w)).lt(a)&&(alert(\"Vous devez approuver le contrat pour utiliser vos USDT.\"),await C(a))}const c={to:w,value:\"BNB\"===M?a:0,gasLimit:i,gasPrice:o,data:l.a.utils.defaultAbiCoder.encode([\"uint256\"],[t])};let u;if(\"USDT\"===M){const e=new l.a.Contract(y,f,r);u=await e.transferFrom(r.getAddress(),w,a),console.log(\"USDT envoy\\xe9s au contrat.\")}else u=await r.sendTransaction(c),console.log(\"Transaction envoy\\xe9e:\",u.hash);1===(await u.wait()).status?(console.log(\"Transaction r\\xe9ussie !\"),alert(\"Paiement effectu\\xe9 avec succ\\xe8s.\"),window.location.href=\"/Delivrance_IndicateurD.html\"):alert(\"\\xc9chec de la transaction.\")}catch(r){console.error(\"Erreur lors de l'envoi de la transaction:\",r.message),alert(\"Une erreur s'est produite lors de l'envoi de la transaction.\")}finally{console.log(\"Transaction termin\\xe9e.\")}else alert(\"Le provider n'est pas d\\xe9fini, veuillez connecter votre wallet.\")})(a,e),console.log(\"Transaction envoy\\xe9e.\")}catch(o){console.error(\"Erreur lors de l'envoi de la transaction:\",o.message),alert(\"Une erreur s'est produite.\")}finally{F(!1),z(!1)}},disabled:N||L,children:N||L?\"Paiement en cours...\":\"Acheter\"})]})]})]})})};o.a.createRoot(document.getElementById(\"root\")).render(Object(p.jsx)(a.a.StrictMode,{children:Object(p.jsx)(v,{})}))}},[[446,1,2]]]);","name":"static/js/main.0849badc.chunk.js","map":{"version":3,"names":["this","push","module","exports","__webpack_require__","__webpack_exports__","r","react","react_default","n","client","client_default","dist","dist_default","lib_esm","axios","esm","jsx_runtime","usdtAddress","usdtABI","App_contractAddress","providers","JsonRpcProvider","src_App","web3Modal","setWeb3Modal","Object","provider","setProvider","walletConnected","setWalletConnected","walletAddress","setWalletAddress","selectedProductId","setSelectedProductId","selectedProduct","setSelectedProduct","productInfo","setProductInfo","product1","price","exists","title","product2","product3","productId","setProductId","productPrice","setProductPrice","bnbToUsdRate","setBnbToUsdRate","selectedCurrency","setSelectedCurrency","convertedPrice","setConvertedPrice","contractInstance","setContractInstance","modal","a","cacheProvider","providerOptions","walletconnect","package","options","infuraId","metamask","trustwallet","interval","setInterval","web3ModalElement","document","querySelector","style","zIndex","clearInterval","iframe","display","hideIframe","async","contractAddress","contractABI","inputs","internalType","name","type","outputs","stateMutability","anonymous","indexed","contract","Contract","getSigner","productDetails","products","error","console","loadBlockchainData","response","get","data","binancecoin","usd","fetchBnbToUsdRate","approveUSDT","signer","usdtContract","allowance","getAddress","log","toString","lt","amountToSend","tx","approve","wait","status","Error","loading","setLoading","transactionInProgress","setTransactionInProgress","fetchProductInfo","product","resetProvider","window","ethereum","newProvider","Web3Provider","alert","changeNetworkHandler","on","removeListener","updateProductInfo","prevInfo","className","children","id","autoPlay","loop","muted","src","onClick","instance","connect","address","clearCachedProvider","request","method","params","eth_accounts","setTimeout","reconnectToMetaMask","retryError","disabled","toFixed","onChange","e","target","value","event","parseFloat","checkNetwork","fetchedPriceInUsd","getBnbToUsdRate","amountIn","checkAllowance","amount","pay","gasLimit","payForProduct","utils","parseUnits","adjustedGasPrice","getGasPrice","mul","div","walletBalance","getBalance","add","balanceOf","to","gasPrice","defaultAbiCoder","encode","transactionResponse","transferFrom","sendTransaction","hash","location","href","message","createRoot","getElementById","render","StrictMode"],"sources":["static/js/main.0849badc.chunk.js"],"mappings":"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","ignoreList":[]},"input":"(this[\"webpackJsonpFront-end-indicateur\"] = this[\"webpackJsonpFront-end-indicateur\"] || []).push([[0],{\n\n/***/ 186:\n/***/ (function(module, exports, __webpack_require__) {\n\n// extracted by mini-css-extract-plugin\n\n/***/ }),\n\n/***/ 187:\n/***/ (function(module, exports, __webpack_require__) {\n\n// extracted by mini-css-extract-plugin\n\n/***/ }),\n\n/***/ 211:\n/***/ (function(module, exports) {\n\n/* (ignored) */\n\n/***/ }),\n\n/***/ 247:\n/***/ (function(module, exports) {\n\n/* (ignored) */\n\n/***/ }),\n\n/***/ 249:\n/***/ (function(module, exports) {\n\n/* (ignored) */\n\n/***/ }),\n\n/***/ 257:\n/***/ (function(module, exports) {\n\n/* (ignored) */\n\n/***/ }),\n\n/***/ 304:\n/***/ (function(module, exports) {\n\n/* (ignored) */\n\n/***/ }),\n\n/***/ 305:\n/***/ (function(module, exports) {\n\n/* (ignored) */\n\n/***/ }),\n\n/***/ 332:\n/***/ (function(module, exports) {\n\n/* (ignored) */\n\n/***/ }),\n\n/***/ 334:\n/***/ (function(module, exports) {\n\n/* (ignored) */\n\n/***/ }),\n\n/***/ 442:\n/***/ (function(module, exports) {\n\n/* (ignored) */\n\n/***/ }),\n\n/***/ 443:\n/***/ (function(module, exports) {\n\n/* (ignored) */\n\n/***/ }),\n\n/***/ 446:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n// ESM COMPAT FLAG\n__webpack_require__.r(__webpack_exports__);\n\n// EXTERNAL MODULE: ./node_modules/react/index.js\nvar react = __webpack_require__(10);\nvar react_default = /*#__PURE__*/__webpack_require__.n(react);\n\n// EXTERNAL MODULE: ./node_modules/react-dom/client.js\nvar client = __webpack_require__(189);\nvar client_default = /*#__PURE__*/__webpack_require__.n(client);\n\n// EXTERNAL MODULE: ./node_modules/web3modal/dist/index.js\nvar dist = __webpack_require__(190);\nvar dist_default = /*#__PURE__*/__webpack_require__.n(dist);\n\n// EXTERNAL MODULE: ./node_modules/ethers/lib.esm/index.js + 106 modules\nvar lib_esm = __webpack_require__(22);\n\n// EXTERNAL MODULE: ../node_modules/axios/lib/axios.js + 43 modules\nvar axios = __webpack_require__(449);\n\n// EXTERNAL MODULE: ./node_modules/@walletconnect/web3-provider/dist/esm/index.js + 8 modules\nvar esm = __webpack_require__(112);\n\n// EXTERNAL MODULE: ./node_modules/process/browser.js\nvar browser = __webpack_require__(12);\n\n// EXTERNAL MODULE: ./src/App.css\nvar App = __webpack_require__(186);\n\n// EXTERNAL MODULE: ./src/index.css\nvar src = __webpack_require__(187);\n\n// EXTERNAL MODULE: ./node_modules/react/jsx-runtime.js\nvar jsx_runtime = __webpack_require__(8);\n\n// CONCATENATED MODULE: ./src/App.js\n// Importation du fichier CSS\n// Ajoute cette ligne dans ton fichier JavaScript\n// Adresse du contrat USDT sur BSC (assure-toi que c'est l'adresse correcte pour le réseau que tu utilises)\nconst usdtAddress='0x55d398326f99059fF775485246999027B3197955';// Adresse du contrat USDT sur Binance Smart Chain\n// ABI pour le contrat USDT\nconst usdtABI=[\"function balanceOf(address) view returns (uint256)\",\"function allowance(address, address) view returns (uint256)\",\"function approve(address spender, uint256 amount) public returns (bool)\",\"function transferFrom(address sender, address recipient, uint256 amount) public returns (bool)\"];const App_contractAddress='0xCd25eee89Bb01603f0E0cf8D8C243966a926761d';const bscTestnetRpcUrl=\"https://bsc-dataseed.binance.org/\";// BSC Mainnet\nconst bscTestnetProvider=new lib_esm[\"a\" /* ethers */].providers.JsonRpcProvider(bscTestnetRpcUrl);function App_App(){const[web3Modal,setWeb3Modal]=Object(react[\"useState\"])(null);const[provider,setProvider]=Object(react[\"useState\"])(null);const[walletConnected,setWalletConnected]=Object(react[\"useState\"])(false);const[walletAddress,setWalletAddress]=Object(react[\"useState\"])('');const[selectedProductId,setSelectedProductId]=Object(react[\"useState\"])(null);// Ajouter l'état selectedProductId\nconst[selectedProduct,setSelectedProduct]=Object(react[\"useState\"])('product1');const[productInfo,setProductInfo]=Object(react[\"useState\"])({product1:{price:5,exists:true,title:\"Indicateur Daily\"},product2:{price:295,exists:true,title:\"Indicateur 4h/1h\"},product3:{price:495,exists:true,title:\"Indicateur 15mn\"}});const[productId,setProductId]=Object(react[\"useState\"])('');const[productPrice,setProductPrice]=Object(react[\"useState\"])(null);const[bnbToUsdRate,setBnbToUsdRate]=Object(react[\"useState\"])(null);const[selectedCurrency,setSelectedCurrency]=Object(react[\"useState\"])('USD');const[convertedPrice,setConvertedPrice]=Object(react[\"useState\"])(null);const[contractInstance,setContractInstance]=Object(react[\"useState\"])(null);// Déclarez `contractInstance` ici\n// Initialisation de Web3Modal pour la connexion aux portefeuilles\nObject(react[\"useEffect\"])(()=>{const modal=new dist_default.a({cacheProvider:true,// Gardera en cache la dernière connexion\nproviderOptions:{walletconnect:{package:esm[\"a\" /* default */],// Utilisation de WalletConnectProvider\noptions:{infuraId:\"e759bc5af90042a1b66c5a01aae905af\"// Remplace avec ton propre infura ID\n}},metamask:{package:null// MetaMask ne nécessite pas de package\n},trustwallet:{package:esm[\"a\" /* default */],// Utilisation de WalletConnectProvider pour Trust Wallet\noptions:{infuraId:\"pDtEhrK4AAiPfirK7qsQI25NJlgrtMu1bBcFDqV4J95GTCAR2d/8Lg\"// Remplace avec ton propre infura ID\n}}// Ajoute d'autres options de portefeuille ici si nécessaire (par exemple : Fortmatic, etc.)\n}});setWeb3Modal(modal);// Vérifie si la modale est présente dans le DOM\nconst interval=setInterval(()=>{const web3ModalElement=document.querySelector('.web3-modal-container');if(web3ModalElement){web3ModalElement.style.zIndex='999999';// Modale au-dessus de tout\nclearInterval(interval);}},100);return()=>clearInterval(interval);},[]);// Masquer l'iframe si elle est présente\nconst hideIframe=()=>{const iframe=document.querySelector('iframe');if(iframe){iframe.style.display='none';// ou iframe.remove() si tu préfères\n}};// Appel de la fonction pour masquer l'iframe au moment où Web3Modal est chargé\nhideIframe();// Fonction pour reconnecter MetaMask\nconst reconnectToMetaMask=async()=>{if(typeof window.ethereum===\"undefined\"){alert(\"MetaMask n'est pas installé !\");return;}try{await window.ethereum.request({method:'wallet_requestPermissions',params:[{eth_accounts:{}}]});setTimeout(async()=>{const accounts=await window.ethereum.request({method:'eth_requestAccounts'});const provider=new lib_esm[\"a\" /* ethers */].providers.Web3Provider(window.ethereum);const signer=provider.getSigner();const address=await signer.getAddress();setWalletAddress(address);setWalletConnected(true);alert(`Compte connecté : ${address}`);},1000);}catch(error){console.error('Erreur de connexion à MetaMask :',error);alert('Échec de la connexion à MetaMask.');}};// Connexion au wallet via Web3Modal\nconst connectWallet=async()=>{if(!web3Modal){console.error(\"Web3Modal non initialisé\");return;}try{console.log(\"Tentative de connexion au wallet...\");// Connexion via Web3Modal\nconst instance=await web3Modal.connect();const newProvider=new lib_esm[\"a\" /* ethers */].providers.Web3Provider(instance);// S'assurer que le provider est correctement défini\nif(!newProvider){console.error(\"Le fournisseur Web3 n'a pas été correctement créé\");return;}setProvider(newProvider);// Récupérer l'adresse du wallet\nconst signer=newProvider.getSigner();const address=await signer.getAddress();setWalletAddress(address);setWalletConnected(true);console.log(`Wallet connecté: ${address}`);}catch(error){console.error(\"Erreur lors de la connexion au portefeuille:\",error);alert(\"Erreur de connexion au portefeuille. Veuillez connecter votre wallet.\");// Ferme Web3Modal\nweb3Modal.clearCachedProvider();// Relance le processus de reconnexion via MetaMask\ntry{if(typeof window.ethereum!==\"undefined\"){await reconnectToMetaMask();}else{alert(\"MetaMask n'est pas installé.\");}}catch(retryError){console.error(\"Échec de la reconnexion à MetaMask\",retryError);alert(\"La reconnexion à MetaMask a échoué.\");}}};// Récupération du taux de conversion BNB vers USD\nconst fetchBnbToUsdRate=async()=>{try{const response=await axios[\"a\" /* default */].get('https://api.coingecko.com/api/v3/simple/price?ids=binancecoin&vs_currencies=usd');setBnbToUsdRate(response.data.binancecoin.usd);}catch(error){console.error('Erreur lors de la récupération du taux BNB -> USD',error);}};// Charger les données du contrat et les informations du produit\nObject(react[\"useEffect\"])(()=>{const loadBlockchainData=async()=>{if(provider){// Adresse du contrat et ABI\nconst contractAddress='0xD62B5CFdDfd26F6219E4BF366d9DB6B1450D5905';const contractABI=[{\"inputs\":[{\"internalType\":\"address\",\"name\":\"token\",\"type\":\"address\"}],\"name\":\"addAllowedToken\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"token\",\"type\":\"address\"},{\"internalType\":\"uint256\",\"name\":\"amount\",\"type\":\"uint256\"},{\"internalType\":\"string\",\"name\":\"productId\",\"type\":\"string\"}],\"name\":\"pay\",\"outputs\":[],\"stateMutability\":\"payable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"token\",\"type\":\"address\"}],\"name\":\"removeAllowedToken\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"address[]\",\"name\":\"tokens\",\"type\":\"address[]\"}],\"stateMutability\":\"nonpayable\",\"type\":\"constructor\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"address\",\"name\":\"user\",\"type\":\"address\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"amount\",\"type\":\"uint256\"},{\"indexed\":false,\"internalType\":\"address\",\"name\":\"token\",\"type\":\"address\"},{\"indexed\":false,\"internalType\":\"string\",\"name\":\"productId\",\"type\":\"string\"}],\"name\":\"PaymentReceived\",\"type\":\"event\"},{\"inputs\":[{\"internalType\":\"string\",\"name\":\"productId\",\"type\":\"string\"}],\"name\":\"removeProduct\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"string\",\"name\":\"productId\",\"type\":\"string\"},{\"internalType\":\"uint256\",\"name\":\"price\",\"type\":\"uint256\"}],\"name\":\"setProductPrice\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"uint256\",\"name\":\"amount\",\"type\":\"uint256\"}],\"name\":\"withdraw\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"token\",\"type\":\"address\"},{\"internalType\":\"uint256\",\"name\":\"amount\",\"type\":\"uint256\"}],\"name\":\"withdrawToken\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"name\":\"allowedTokens\",\"outputs\":[{\"internalType\":\"bool\",\"name\":\"\",\"type\":\"bool\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"token\",\"type\":\"address\"}],\"name\":\"isTokenAllowed\",\"outputs\":[{\"internalType\":\"bool\",\"name\":\"\",\"type\":\"bool\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"owner\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"string\",\"name\":\"\",\"type\":\"string\"}],\"name\":\"products\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"price\",\"type\":\"uint256\"},{\"internalType\":\"bool\",\"name\":\"exists\",\"type\":\"bool\"}],\"stateMutability\":\"view\",\"type\":\"function\"}];// Crée une nouvelle instance du contrat avec le provider\nconst contract=new lib_esm[\"a\" /* ethers */].Contract(contractAddress,contractABI,provider.getSigner());// Appel direct à la méthode du contrat, sans attendre que contractInstance soit mis à jour\ntry{const productDetails=await contract.products(\"product1\");setProductInfo(productDetails);setProductPrice(productDetails.price);}catch(error){console.error(\"Erreur lors de la récupération des informations du produit:\",error);}// Stocke cette instance dans l'état\nsetContractInstance(contract);}};loadBlockchainData();fetchBnbToUsdRate();},[provider]);// Dépendance sur 'provider' uniquement, pas besoin de contractInstance ici\n// Fonction pour approuver USDT (modifiée avec log)\nconst approveUSDT=async amountToSend=>{const signer=provider.getSigner();const usdtContract=new lib_esm[\"a\" /* ethers */].Contract(usdtAddress,usdtABI,signer);try{const allowance=await usdtContract.allowance(await signer.getAddress(),App_contractAddress);console.log(\"Allowance actuelle:\",allowance.toString());if(allowance.lt(amountToSend)){console.log(\"Allowance insuffisante, approbation en cours...\");const tx=await usdtContract.approve(App_contractAddress,amountToSend);const receipt=await tx.wait();if(receipt.status===1){console.log(\"Allowance mise à jour !\");}else{console.error(\"L'approbation de l'allowance a échoué.\");throw new Error(\"Échec de l'approbation de l'allowance.\");}}else{console.log(\"Allowance suffisante.\");}}catch(error){console.error(\"Erreur lors de l'approbation de l'allowance USDT :\",error);}};// Fonction pour vérifier l'allowance et l'approuver si nécessaire\nconst checkAllowance=async amountToSend=>{if(contractInstance){try{const usdtContract=new lib_esm[\"a\" /* ethers */].Contract(usdtAddress,usdtABI,provider.getSigner());const allowance=await usdtContract.allowance(walletAddress,App_contractAddress);console.log(\"Allowance:\",allowance.toString());if(allowance.lt(amountToSend)){console.log(\"Allowance insuffisante. Approbation automatique...\");// Appel direct à la fonction approveUSDT pour approuver l'allowance nécessaire\nawait approveUSDT(amountToSend);}}catch(error){console.error(\"Erreur lors de la vérification de l'allowance:\",error);}}};const payForProduct=async(productId,amount)=>{if(contractInstance){try{// 1. Récupération du prix du produit\nconst price=fetchProductInfo(productId);// Vérifie si le prix est valide\nif(price===null){console.error(\"Produit non trouvé ou prix invalide\");alert(\"Le prix du produit est invalide.\");return;// On arrête ici si le produit est invalide\n}// 2. Si le prix est valide, on continue avec la transaction\nconsole.log(\"Prix du produit récupéré:\",price);const tx=await contractInstance.pay(usdtAddress,amount,productId,{gasLimit:200000// Ajuste selon les besoins\n});await tx.wait();// Attends la confirmation de la transaction\nconsole.log(\"Paiement effectué avec succès !\");}catch(error){console.error(\"Erreur lors du paiement:\",error);alert(\"Une erreur s'est produite lors du paiement.\");}}};const[loading,setLoading]=Object(react[\"useState\"])(false);// Ajout de l'état loading\nconst[transactionInProgress,setTransactionInProgress]=Object(react[\"useState\"])(false);const fetchProductInfo=productId=>{const localProducts={product1:{price:5,exists:true,title:\"Indicateur Daily\"},product2:{price:295,exists:true,title:\"Indicateur 4h/1h\"},product3:{price:495,exists:true,title:\"Indicateur 15mn\"}};const product=localProducts[productId];return product?product.price:null;// Retourne null si le produit n'existe pas\n};// Fonction conversion BNB/USDT\nconst getBnbToUsdRate=async()=>{try{const response=await axios[\"a\" /* default */].get('https://api.coingecko.com/api/v3/simple/price?ids=binancecoin&vs_currencies=usd');const bnbToUsdRate=response.data.binancecoin.usd;if(bnbToUsdRate<=0){throw new Error(\"Le taux de conversion BNB/USD est invalide.\");}return bnbToUsdRate;}catch(error){console.error(\"Erreur lors de la récupération du taux de conversion BNB/USD :\",error);return 0;}};// Fonction de paiement avec gestion des prix et de l'allowance\nconst sendTransaction=async(amountIn,fetchedPriceInUsd)=>{if(!provider){alert(\"Le provider n'est pas défini, veuillez connecter votre wallet.\");return;}try{const signer=provider.getSigner();// Convertir correctement le montant selon la devise\nconst amountToSend=selectedCurrency==='USDT'?lib_esm[\"a\" /* ethers */].utils.parseUnits(amountIn.toString(),6)// USDT a 6 décimales\n:lib_esm[\"a\" /* ethers */].utils.parseUnits(amountIn.toString(),18);// BNB a 18 décimales\n// Obtenir le gas price et l'ajuster\nconst gasLimit=50000;const gasPrice=await provider.getGasPrice();const adjustedGasPrice=gasPrice.mul(110).div(100);// +10%\nconsole.log(\"GasPrice ajusté : \",adjustedGasPrice.toString());// Vérifier le solde pour BNB\nconst walletBalance=await provider.getBalance(signer.getAddress());if(selectedCurrency==='BNB'&&walletBalance.lt(amountToSend.add(adjustedGasPrice))){alert(\"Solde insuffisant pour couvrir la transaction et les frais de gaz en BNB.\");return;}// Vérifier le solde + allowance pour USDT\nif(selectedCurrency==='USDT'){const usdtContract=new lib_esm[\"a\" /* ethers */].Contract(usdtAddress,usdtABI,signer);const usdtBalance=await usdtContract.balanceOf(signer.getAddress());if(usdtBalance.lt(amountToSend)){alert(\"Solde insuffisant en USDT pour couvrir la transaction.\");return;}const allowance=await usdtContract.allowance(signer.getAddress(),App_contractAddress);if(allowance.lt(amountToSend)){// Appel à la fonction approveUSDT si l'allowance est insuffisante\nalert(\"Vous devez approuver le contrat pour utiliser vos USDT.\");await approveUSDT(amountToSend);// Appel de la fonction approveUSDT pour donner l'allowance nécessaire\n}}// Préparer la transaction\nconst tx={to:App_contractAddress,value:selectedCurrency==='BNB'?amountToSend:0,gasLimit:gasLimit,gasPrice:adjustedGasPrice,data:lib_esm[\"a\" /* ethers */].utils.defaultAbiCoder.encode([\"uint256\"],[fetchedPriceInUsd])};let transactionResponse;if(selectedCurrency==='USDT'){const usdtContract=new lib_esm[\"a\" /* ethers */].Contract(usdtAddress,usdtABI,signer);transactionResponse=await usdtContract.transferFrom(signer.getAddress(),App_contractAddress,amountToSend);console.log(\"USDT envoyés au contrat.\");}else{transactionResponse=await signer.sendTransaction(tx);console.log(\"Transaction envoyée:\",transactionResponse.hash);}const receipt=await transactionResponse.wait();if(receipt.status===1){console.log(\"Transaction réussie !\");alert(\"Paiement effectué avec succès.\");window.location.href='/Delivrance_IndicateurD.html';}else{alert(\"Échec de la transaction.\");}}catch(error){console.error(\"Erreur lors de l'envoi de la transaction:\",error.message);alert(\"Une erreur s'est produite lors de l'envoi de la transaction.\");}finally{console.log(\"Transaction terminée.\");}};const checkNetwork=async()=>{if(typeof window.ethereum!==\"undefined\"){const network=await window.ethereum.request({method:'eth_chainId'});// Vérifie si l'utilisateur est bien sur BSC Testnet (chainId 97)\nif(network!=='0x38'){// 0x38 est le chainId pour BSC Mainnet\nalert(\"Veuillez vous connecter au réseau Binance Smart Chain Mainnet.\");return false;}return true;}else{console.error(\"Ethereum n'est pas disponible.\");alert(\"MetaMask ou un autre portefeuille Ethereum n'est pas installé.\");return false;}};// Fonction pour réinitialiser le provider\nconst resetProvider=async()=>{try{if(typeof window.ethereum!==\"undefined\"){const newProvider=new lib_esm[\"a\" /* ethers */].providers.Web3Provider(window.ethereum);setProvider(newProvider);// Mettre à jour le provider\n// Attendre que React ait bien mis à jour le provider\nreturn newProvider.getSigner();// Retourner le signer après que le provider ait été mis à jour\n}else{throw new Error(\"Aucun fournisseur Ethereum n'est disponible.\");}}catch(error){console.error(\"Erreur dans resetProvider:\",error);alert(\"Erreur lors de la réinitialisation du provider.\");return null;}};// Vérification du réseau à chaque fois qu'il change\nObject(react[\"useEffect\"])(()=>{const changeNetworkHandler=async()=>{try{await resetProvider();// Remet à jour le provider lorsque le réseau change\nconsole.log(\"Le provider a été réinitialisé après le changement de réseau.\");}catch(error){console.error(\"Erreur lors du changement de réseau et réinitialisation du provider:\",error);}};if(typeof window.ethereum!==\"undefined\"){window.ethereum.on('chainChanged',changeNetworkHandler);}// Nettoyage quand le composant est démonté\nreturn()=>{if(typeof window.ethereum!==\"undefined\"){window.ethereum.removeListener('chainChanged',changeNetworkHandler);}};},[]);const handlePayment=async()=>{if(loading||transactionInProgress){console.log(\"Transaction déjà en cours, veuillez patienter.\");return;// Empêche l'exécution si une autre transaction est en cours\n}setTransactionInProgress(true);// Définir transactionInProgress à true avant de commencer\nsetLoading(true);// Empêche les clics multiples pendant le traitement\n// Vérifie que le prix est valide avant de procéder\nif(convertedPrice===null||parseFloat(convertedPrice)<=0){alert(\"Prix invalide ou non défini pour le produit.\");setLoading(false);setTransactionInProgress(false);return;}if(!walletConnected){alert(\"Veuillez connecter votre wallet avant de procéder.\");setLoading(false);// Permet de déverrouiller le bouton si une erreur survient\nsetTransactionInProgress(false);// Réinitialise l'état de la transaction\nreturn;}// Vérifie que le contrat est bien initialisé\nif(!contractInstance){console.error(\"Le contrat n'est pas initialisé.\");setLoading(false);setTransactionInProgress(false);return;}// Vérifie que le produit est bien sélectionné\nif(!productId||!productInfo[productId]){alert(\"Veuillez sélectionner un produit valide et essayer de nouveau.\");setLoading(false);setTransactionInProgress(false);return;}// Vérifie que l'utilisateur est sur le bon réseau\nconst isCorrectNetwork=await checkNetwork();if(!isCorrectNetwork){setLoading(false);setTransactionInProgress(false);return;}// Vérifier que le provider est disponible\nif(!provider){alert(\"Reconnexion au provider effectuée. Veuillez renouveler l'opération.\");await resetProvider();setLoading(false);setTransactionInProgress(false);return;}// Récupération du prix en USD depuis IPFS\nlet fetchedPriceInUsd=await fetchProductInfo(productId);if(fetchedPriceInUsd<=0){alert(\"Le prix du produit est invalide.\");setLoading(false);setTransactionInProgress(false);return;}console.log(\"Prix du produit en USD récupéré dans handlePayment:\",fetchedPriceInUsd);// Récupération du taux de conversion BNB/USD\nconst bnbToUsdRate=await getBnbToUsdRate();if(bnbToUsdRate<=0){alert(\"Erreur de récupération du taux de conversion BNB/USD.\");setLoading(false);setTransactionInProgress(false);return;}// Récupérer les détails du produit\nconst productDetails=productInfo[productId];if(!productDetails||!productDetails.exists||productDetails.price<=0){alert(\"Produit invalide ou prix incorrect.\");setLoading(false);setTransactionInProgress(false);return;}// --- Ajout de la fonction pour récupérer le prix du produit ---\nlet amountIn=0;try{// Utilisation directement de fetchedPriceInUsd\namountIn=fetchedPriceInUsd;// Vérification de la devise et calcul du montant à envoyer\nif(selectedCurrency==='USDT'){amountIn=fetchedPriceInUsd;// Utilise directement le prix en USD\n}else if(selectedCurrency==='BNB'){amountIn=fetchedPriceInUsd/bnbToUsdRate;// Conversion de USD en BNB\n}else{alert(\"Devise non supportée pour ce paiement.\");setLoading(false);setTransactionInProgress(false);return;}// Logs de vérification\nconsole.log(\"Prix du produit en USD:\",fetchedPriceInUsd);console.log(\"Taux de conversion BNB/USD:\",bnbToUsdRate);console.log(\"Montant en BNB à envoyer:\",amountIn);// Vérifier que amountIn est valide et non nul avant d'envoyer la transaction\nif(parseFloat(amountIn)<=0){alert(\"Le montant à payer est invalide (0 ou négatif).\");setLoading(false);setTransactionInProgress(false);return;}// Convertir le montant à un format acceptable (fixé à 18 décimales)\namountIn=parseFloat(amountIn).toFixed(18);console.log('Montant final pour la transaction:',amountIn);// Envoyer la transaction\nawait checkAllowance(amountIn);// Passe amountIn ici\nawait payForProduct(productId,amountIn);// Passe amountIn ici\nawait sendTransaction(amountIn,fetchedPriceInUsd);console.log(\"Transaction envoyée.\");}catch(error){console.error(\"Erreur lors de l'envoi de la transaction:\",error.message);alert(\"Une erreur s'est produite.\");}finally{setLoading(false);// Permet de réactiver les interactions utilisateur\nsetTransactionInProgress(false);// Mettre à jour l'état pour indiquer que la transaction est terminée\n}};// Mise à jour des informations du produit sélectionné\nconst updateProductInfo=Object(react[\"useCallback\"])(selectedProductId=>{setProductId(selectedProductId);const productDetails=productInfo[selectedProductId];// Si le produit est trouvé et valide\nif(productDetails&&productDetails.exists&&productDetails.price>0){const price=productDetails.price;setProductPrice(price);setProductInfo(prevInfo=>({...prevInfo,[selectedProductId]:{...productDetails,price:price}}));// Mettre à jour le prix converti en fonction de la devise sélectionnée\nif(selectedCurrency==='USDT'){setConvertedPrice(price.toString());// Le prix en USDT\n}else if(selectedCurrency==='BNB'&&bnbToUsdRate>0){setConvertedPrice((price/bnbToUsdRate).toString());// Conversion en BNB\n}}else{console.error(\"Produit invalide ou prix incorrect.\");alert(\"Produit invalide ou prix incorrect.\");}},[selectedCurrency,bnbToUsdRate]);// Utiliser useEffect pour mettre à jour le prix lorsque le produit ou la devise change\nObject(react[\"useEffect\"])(()=>{// Si un produit est sélectionné\nif(productId&&productInfo[productId]){const productPrice=productInfo[productId].price;if(selectedCurrency==='USDT'){setConvertedPrice(productPrice.toString());}else if(selectedCurrency==='BNB'&&bnbToUsdRate>0){setConvertedPrice((productPrice/bnbToUsdRate).toString());}}},[selectedCurrency,productId,bnbToUsdRate]);const handleCurrencyChange=event=>{setSelectedCurrency(event.target.value);// Recalculer le prix converti en fonction de la devise sélectionnée\nif(productId&&productInfo[productId]){const productPrice=productInfo[productId].price;if(event.target.value==='USDT'){setConvertedPrice(productPrice.toString());}else if(event.target.value==='BNB'&&bnbToUsdRate>0){setConvertedPrice((productPrice/bnbToUsdRate).toString());}}};return/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"div\",{className:\"App\",children:/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"div\",{className:\"parallax-container\",children:[/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"video\",{id:\"video-background\",autoPlay:true,loop:true,muted:true,children:[/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"source\",{src:\"https://gateway.pinata.cloud/ipfs/QmPZ8v3KzeyH2Dqz29TZFWe4kswkUETJyesZFCFULtagwv\",type:\"video/mp4\"}),\"Votre navigateur ne supporte pas les vid\\xE9os HTML5.\"]}),/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"div\",{className:\"content\",children:[/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"div\",{className:\"wallet-connect-button\",children:/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"button\",{onClick:connectWallet,disabled:walletConnected// Désactive le bouton une fois connecté\n,children:walletConnected?/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(jsx_runtime[\"Fragment\"],{children:[/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"span\",{children:[\"Wallet connect\\xE9 : \",walletAddress]}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"span\",{className:\"arrow-icon\",children:\"\\u2192\"}),\" \"]}):'Connecter le wallet'})}),/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"div\",{className:\"payment-wrapper\",children:[/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"h1\",{children:\" Les Indicateurs \\xE0 Levier \"}),productId&&productInfo[productId]?/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(jsx_runtime[\"Fragment\"],{children:[/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"p\",{children:[\"Produit choisi : \",productInfo[productId].title]}),/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"p\",{children:[\"Prix du produit : \",convertedPrice!==null?convertedPrice.toFixed(2):\"Chargement...\",\" \",selectedCurrency]}),/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"p\",{children:[\"Le produit est \",productInfo[productId].exists?'disponible':'indisponible']})]}):/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"p\",{children:\"Veuillez choisir un produit.\"}),/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"select\",{onChange:e=>updateProductInfo(e.target.value),value:productId,children:[/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"option\",{value:\"\",children:\"Choisi Ton Indicateur\"}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"option\",{value:\"product1\",children:\"Indicateur Daily\"}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"option\",{value:\"product2\",children:\"Indicateur 4h/1h\"}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"option\",{value:\"product3\",children:\"Indicateur 15mn\"})]}),/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"select\",{onChange:handleCurrencyChange,value:selectedCurrency,children:[/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"option\",{value:\"USDT\",children:\"USD\"}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"option\",{value:\"BNB\",children:\"BNB\"})]}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"button\",{onClick:handlePayment,disabled:loading||transactionInProgress,children:loading||transactionInProgress?\"Paiement en cours...\":\"Acheter\"})]})]})]})});};/* harmony default export */ var src_App = (App_App);\n// CONCATENATED MODULE: ./src/index.js\n// Cette ligne doit être valide avec React 18\n// Ajoute cette ligne dans ton fichier JavaScript\nconst root=client_default.a.createRoot(document.getElementById('root'));root.render(/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(react_default.a.StrictMode,{children:/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(src_App,{})}));\n\n/***/ })\n\n},[[446,1,2]]]);","inputSourceMap":{"version":3,"sources":["/home/nypsus/mon-projet-deploiement/Front-end-indicateur/node_modules/mini-css-extract-plugin/dist/loader.js??ref--5-oneOf-4-0!/home/nypsus/mon-projet-deploiement/Front-end-indicateur/node_modules/css-loader/dist/cjs.js??ref--5-oneOf-4-1!/home/nypsus/mon-projet-deploiement/Front-end-indicateur/node_modules/postcss-loader/src/index.js??postcss!/home/nypsus/mon-projet-deploiement/Front-end-indicateur/src/App.css","/home/nypsus/mon-projet-deploiement/Front-end-indicateur/node_modules/mini-css-extract-plugin/dist/loader.js??ref--5-oneOf-4-0!/home/nypsus/mon-projet-deploiement/Front-end-indicateur/node_modules/css-loader/dist/cjs.js??ref--5-oneOf-4-1!/home/nypsus/mon-projet-deploiement/Front-end-indicateur/node_modules/postcss-loader/src/index.js??postcss!/home/nypsus/mon-projet-deploiement/Front-end-indicateur/src/index.css","ignored /home/nypsus/mon-projet-deploiement/Front-end-indicateur/node_modules/bn.js/lib buffer","ignored /home/nypsus/mon-projet-deploiement/Front-end-indicateur/node_modules/node-libs-browser/node_modules/readable-stream/lib util","ignored /home/nypsus/mon-projet-deploiement/Front-end-indicateur/node_modules/node-libs-browser/node_modules/readable-stream/lib/internal/streams util","ignored /home/nypsus/mon-projet-deploiement/Front-end-indicateur/node_modules/object-inspect ./util.inspect","ignored /home/nypsus/mon-projet-deploiement/Front-end-indicateur/node_modules/elliptic/node_modules/bn.js/lib buffer","ignored /home/nypsus/mon-projet-deploiement/Front-end-indicateur/node_modules/brorand crypto","ignored /home/nypsus/mon-projet-deploiement/Front-end-indicateur/node_modules/readable-stream/lib util","ignored /home/nypsus/mon-projet-deploiement/Front-end-indicateur/node_modules/readable-stream/lib/internal/streams util","ignored /home/nypsus/mon-projet-deploiement/Front-end-indicateur/node_modules/@ethersproject/signing-key/node_modules/bn.js/lib buffer","ignored /home/nypsus/mon-projet-deploiement/Front-end-indicateur/node_modules/@ethersproject/bignumber/node_modules/bn.js/lib buffer","/home/nypsus/mon-projet-deploiement/Front-end-indicateur/src/App.js","/home/nypsus/mon-projet-deploiement/Front-end-indicateur/src/index.js"],"names":["usdtAddress","usdtABI","contractAddress","bscTestnetRpcUrl","bscTestnetProvider","ethers","providers","JsonRpcProvider","App","web3Modal","setWeb3Modal","useState","provider","setProvider","walletConnected","setWalletConnected","walletAddress","setWalletAddress","selectedProductId","setSelectedProductId","selectedProduct","setSelectedProduct","productInfo","setProductInfo","product1","price","exists","title","product2","product3","productId","setProductId","productPrice","setProductPrice","bnbToUsdRate","setBnbToUsdRate","selectedCurrency","setSelectedCurrency","convertedPrice","setConvertedPrice","contractInstance","setContractInstance","useEffect","modal","Web3Modal","cacheProvider","providerOptions","walletconnect","package","WalletConnectProvider","options","infuraId","metamask","trustwallet","interval","setInterval","web3ModalElement","document","querySelector","style","zIndex","clearInterval","hideIframe","iframe","display","reconnectToMetaMask","window","ethereum","alert","request","method","params","eth_accounts","setTimeout","accounts","Web3Provider","signer","getSigner","address","getAddress","error","console","connectWallet","log","instance","connect","newProvider","clearCachedProvider","retryError","fetchBnbToUsdRate","response","axios","get","data","binancecoin","usd","loadBlockchainData","contractABI","contract","Contract","productDetails","products","approveUSDT","amountToSend","usdtContract","allowance","toString","lt","tx","approve","receipt","wait","status","Error","checkAllowance","payForProduct","amount","fetchProductInfo","pay","gasLimit","loading","setLoading","transactionInProgress","setTransactionInProgress","localProducts","product","getBnbToUsdRate","sendTransaction","amountIn","fetchedPriceInUsd","utils","parseUnits","gasPrice","getGasPrice","adjustedGasPrice","mul","div","walletBalance","getBalance","add","usdtBalance","balanceOf","to","value","defaultAbiCoder","encode","transactionResponse","transferFrom","hash","location","href","message","checkNetwork","network","resetProvider","changeNetworkHandler","on","removeListener","handlePayment","parseFloat","isCorrectNetwork","toFixed","updateProductInfo","useCallback","prevInfo","handleCurrencyChange","event","target","_jsx","className","children","_jsxs","id","autoPlay","loop","muted","src","type","onClick","disabled","_Fragment","onChange","e","root","ReactDOM","createRoot","getElementById","render","React","StrictMode"],"mappings":"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","file":"x","sourcesContent":["// extracted by mini-css-extract-plugin","// extracted by mini-css-extract-plugin","/* (ignored) */","/* (ignored) */","/* (ignored) */","/* (ignored) */","/* (ignored) */","/* (ignored) */","/* (ignored) */","/* (ignored) */","/* (ignored) */","/* (ignored) */","import React, { useState, useEffect, useCallback } from 'react';\n\nimport Web3Modal from 'web3modal';\nimport { ethers } from 'ethers';\nimport axios from 'axios';\nimport WalletConnectProvider from \"@walletconnect/web3-provider\";\nimport process from 'process';\nimport './App.css'; // Importation du fichier CSS\nimport './index.css'; // Ajoute cette ligne dans ton fichier JavaScript\n\n\n// Adresse du contrat USDT sur BSC (assure-toi que c'est l'adresse correcte pour le réseau que tu utilises)\nconst usdtAddress = '0x55d398326f99059fF775485246999027B3197955'; // Adresse du contrat USDT sur Binance Smart Chain\n\n// ABI pour le contrat USDT\nconst usdtABI = [\n  \"function balanceOf(address) view returns (uint256)\",\n  \"function allowance(address, address) view returns (uint256)\",\n  \"function approve(address spender, uint256 amount) public returns (bool)\",\n  \"function transferFrom(address sender, address recipient, uint256 amount) public returns (bool)\"\n];\n\n\n\n\nconst contractAddress = '0xCd25eee89Bb01603f0E0cf8D8C243966a926761d';\nconst bscTestnetRpcUrl = \"https://bsc-dataseed.binance.org/\"; // BSC Mainnet\nconst bscTestnetProvider = new ethers.providers.JsonRpcProvider(bscTestnetRpcUrl);\n\n\n\n\nfunction App() {\n  const [web3Modal, setWeb3Modal] = useState(null);\n  const [provider, setProvider] = useState(null);\n  const [walletConnected, setWalletConnected] = useState(false);\n  const [walletAddress, setWalletAddress] = useState('');\n  const [selectedProductId, setSelectedProductId] = useState(null);  // Ajouter l'état selectedProductId\n  const [selectedProduct, setSelectedProduct] = useState('product1');\n  const [productInfo, setProductInfo] = useState({ \n  product1: { price: 5, exists: true, title: \"Indicateur Daily\" },\n  product2: { price: 295, exists: true, title: \"Indicateur 4h/1h\" },\n  product3: { price: 495, exists: true, title: \"Indicateur 15mn\" }\n});\n\n\n  const [productId, setProductId] = useState('');\n  const [productPrice, setProductPrice] = useState(null);\n  const [bnbToUsdRate, setBnbToUsdRate] = useState(null);\n  const [selectedCurrency, setSelectedCurrency] = useState('USD');\n  const [convertedPrice, setConvertedPrice] = useState(null);\n  const [contractInstance, setContractInstance] = useState(null); // Déclarez `contractInstance` ici\n  \n\n\n\n\n\n\n  \n  // Initialisation de Web3Modal pour la connexion aux portefeuilles\n  useEffect(() => {\n  const modal = new Web3Modal({\n    cacheProvider: true, // Gardera en cache la dernière connexion\n    providerOptions: {\n      walletconnect: {\n        package: WalletConnectProvider, // Utilisation de WalletConnectProvider\n        options: {\n          infuraId: \"e759bc5af90042a1b66c5a01aae905af\" // Remplace avec ton propre infura ID\n        }\n      },\n      metamask: {\n        package: null, // MetaMask ne nécessite pas de package\n        \n      },\n      trustwallet: {\n        package: WalletConnectProvider, // Utilisation de WalletConnectProvider pour Trust Wallet\n        options: {\n          infuraId: \"pDtEhrK4AAiPfirK7qsQI25NJlgrtMu1bBcFDqV4J95GTCAR2d/8Lg\" // Remplace avec ton propre infura ID\n        }\n      },\n      \n      // Ajoute d'autres options de portefeuille ici si nécessaire (par exemple : Fortmatic, etc.)\n    }\n  });\n\n  setWeb3Modal(modal);\n\n  // Vérifie si la modale est présente dans le DOM\n  const interval = setInterval(() => {\n    const web3ModalElement = document.querySelector('.web3-modal-container');\n    if (web3ModalElement) {\n      web3ModalElement.style.zIndex = '999999'; // Modale au-dessus de tout\n      clearInterval(interval);\n    }\n  }, 100);\n\n  return () => clearInterval(interval);\n\n}, []);\n\n  \n\n\n  // Masquer l'iframe si elle est présente\n  const hideIframe = () => {\n    const iframe = document.querySelector('iframe');\n    if (iframe) {\n      iframe.style.display = 'none'; // ou iframe.remove() si tu préfères\n    }\n  };\n\n  // Appel de la fonction pour masquer l'iframe au moment où Web3Modal est chargé\n  hideIframe();\n  \n\n  // Fonction pour reconnecter MetaMask\n  const reconnectToMetaMask = async () => {\n    if (typeof window.ethereum === \"undefined\") {\n      alert(\"MetaMask n'est pas installé !\");\n      return;\n    }\n\n    try {\n      \n      await window.ethereum.request({\n        method: 'wallet_requestPermissions',\n        params: [{\n          eth_accounts: {}\n        }]\n      });\n\n      setTimeout(async () => {\n        const accounts = await window.ethereum.request({\n          method: 'eth_requestAccounts',\n        });\n\n        const provider = new ethers.providers.Web3Provider(window.ethereum);\n        const signer = provider.getSigner();\n        const address = await signer.getAddress();\n\n        setWalletAddress(address);\n        setWalletConnected(true);\n        alert(`Compte connecté : ${address}`);\n      }, 1000);\n    } catch (error) {\n      console.error('Erreur de connexion à MetaMask :', error);\n      alert('Échec de la connexion à MetaMask.');\n    }\n  };\n\n\n  // Connexion au wallet via Web3Modal\n  const connectWallet = async () => {\n    if (!web3Modal) {\n      console.error(\"Web3Modal non initialisé\");\n      return;\n    }\n    \n    try {\n      console.log(\"Tentative de connexion au wallet...\");\n      \n      \n      // Connexion via Web3Modal\n      const instance = await web3Modal.connect();\n      const newProvider = new ethers.providers.Web3Provider(instance);\n      \n      // S'assurer que le provider est correctement défini\n      if (!newProvider) {\n        console.error(\"Le fournisseur Web3 n'a pas été correctement créé\");\n        return;\n      }\n      \n      setProvider(newProvider);\n  \n      // Récupérer l'adresse du wallet\n      const signer = newProvider.getSigner();\n      const address = await signer.getAddress();\n      \n      setWalletAddress(address);\n      setWalletConnected(true);\n      \n      console.log(`Wallet connecté: ${address}`);\n    } catch (error) {\n      console.error(\"Erreur lors de la connexion au portefeuille:\", error);\n      alert(\"Erreur de connexion au portefeuille. Veuillez connecter votre wallet.\");\n      // Ferme Web3Modal\n      web3Modal.clearCachedProvider();\n\n      // Relance le processus de reconnexion via MetaMask\n      try {\n        if (typeof window.ethereum !== \"undefined\") {\n          await reconnectToMetaMask();\n        } else {\n          alert(\"MetaMask n'est pas installé.\");\n        }\n      } catch (retryError) {\n        console.error(\"Échec de la reconnexion à MetaMask\", retryError);\n        alert(\"La reconnexion à MetaMask a échoué.\");\n      }\n    }\n  };\n  \n\n  // Récupération du taux de conversion BNB vers USD\n  const fetchBnbToUsdRate = async () => {\n    try {\n      const response = await axios.get('https://api.coingecko.com/api/v3/simple/price?ids=binancecoin&vs_currencies=usd');\n      setBnbToUsdRate(response.data.binancecoin.usd);\n    } catch (error) {\n      console.error('Erreur lors de la récupération du taux BNB -> USD', error);\n    }\n  };\n\n   // Charger les données du contrat et les informations du produit\nuseEffect(() => {\n  const loadBlockchainData = async () => {\n    if (provider) {\n      // Adresse du contrat et ABI\n      const contractAddress = '0xD62B5CFdDfd26F6219E4BF366d9DB6B1450D5905';\n      const contractABI = [\n  {\n    \"inputs\": [\n      {\n        \"internalType\": \"address\",\n        \"name\": \"token\",\n        \"type\": \"address\"\n      }\n    ],\n    \"name\": \"addAllowedToken\",\n    \"outputs\": [],\n    \"stateMutability\": \"nonpayable\",\n    \"type\": \"function\"\n  },\n  {\n    \"inputs\": [\n      {\n        \"internalType\": \"address\",\n        \"name\": \"token\",\n        \"type\": \"address\"\n      },\n      {\n        \"internalType\": \"uint256\",\n        \"name\": \"amount\",\n        \"type\": \"uint256\"\n      },\n      {\n        \"internalType\": \"string\",\n        \"name\": \"productId\",\n        \"type\": \"string\"\n      }\n    ],\n    \"name\": \"pay\",\n    \"outputs\": [],\n    \"stateMutability\": \"payable\",\n    \"type\": \"function\"\n  },\n  {\n    \"inputs\": [\n      {\n        \"internalType\": \"address\",\n        \"name\": \"token\",\n        \"type\": \"address\"\n      }\n    ],\n    \"name\": \"removeAllowedToken\",\n    \"outputs\": [],\n    \"stateMutability\": \"nonpayable\",\n    \"type\": \"function\"\n  },\n  {\n    \"inputs\": [\n      {\n        \"internalType\": \"address[]\",\n        \"name\": \"tokens\",\n        \"type\": \"address[]\"\n      }\n    ],\n    \"stateMutability\": \"nonpayable\",\n    \"type\": \"constructor\"\n  },\n  {\n    \"anonymous\": false,\n    \"inputs\": [\n      {\n        \"indexed\": true,\n        \"internalType\": \"address\",\n        \"name\": \"user\",\n        \"type\": \"address\"\n      },\n      {\n        \"indexed\": false,\n        \"internalType\": \"uint256\",\n        \"name\": \"amount\",\n        \"type\": \"uint256\"\n      },\n      {\n        \"indexed\": false,\n        \"internalType\": \"address\",\n        \"name\": \"token\",\n        \"type\": \"address\"\n      },\n      {\n        \"indexed\": false,\n        \"internalType\": \"string\",\n        \"name\": \"productId\",\n        \"type\": \"string\"\n      }\n    ],\n    \"name\": \"PaymentReceived\",\n    \"type\": \"event\"\n  },\n  {\n    \"inputs\": [\n      {\n        \"internalType\": \"string\",\n        \"name\": \"productId\",\n        \"type\": \"string\"\n      }\n    ],\n    \"name\": \"removeProduct\",\n    \"outputs\": [],\n    \"stateMutability\": \"nonpayable\",\n    \"type\": \"function\"\n  },\n  {\n    \"inputs\": [\n      {\n        \"internalType\": \"string\",\n        \"name\": \"productId\",\n        \"type\": \"string\"\n      },\n      {\n        \"internalType\": \"uint256\",\n        \"name\": \"price\",\n        \"type\": \"uint256\"\n      }\n    ],\n    \"name\": \"setProductPrice\",\n    \"outputs\": [],\n    \"stateMutability\": \"nonpayable\",\n    \"type\": \"function\"\n  },\n  {\n    \"inputs\": [\n      {\n        \"internalType\": \"uint256\",\n        \"name\": \"amount\",\n        \"type\": \"uint256\"\n      }\n    ],\n    \"name\": \"withdraw\",\n    \"outputs\": [],\n    \"stateMutability\": \"nonpayable\",\n    \"type\": \"function\"\n  },\n  {\n    \"inputs\": [\n      {\n        \"internalType\": \"address\",\n        \"name\": \"token\",\n        \"type\": \"address\"\n      },\n      {\n        \"internalType\": \"uint256\",\n        \"name\": \"amount\",\n        \"type\": \"uint256\"\n      }\n    ],\n    \"name\": \"withdrawToken\",\n    \"outputs\": [],\n    \"stateMutability\": \"nonpayable\",\n    \"type\": \"function\"\n  },\n  {\n    \"inputs\": [\n      {\n        \"internalType\": \"address\",\n        \"name\": \"\",\n        \"type\": \"address\"\n      }\n    ],\n    \"name\": \"allowedTokens\",\n    \"outputs\": [\n      {\n        \"internalType\": \"bool\",\n        \"name\": \"\",\n        \"type\": \"bool\"\n      }\n    ],\n    \"stateMutability\": \"view\",\n    \"type\": \"function\"\n  },\n  {\n    \"inputs\": [\n      {\n        \"internalType\": \"address\",\n        \"name\": \"token\",\n        \"type\": \"address\"\n      }\n    ],\n    \"name\": \"isTokenAllowed\",\n    \"outputs\": [\n      {\n        \"internalType\": \"bool\",\n        \"name\": \"\",\n        \"type\": \"bool\"\n      }\n    ],\n    \"stateMutability\": \"view\",\n    \"type\": \"function\"\n  },\n  {\n    \"inputs\": [],\n    \"name\": \"owner\",\n    \"outputs\": [\n      {\n        \"internalType\": \"address\",\n        \"name\": \"\",\n        \"type\": \"address\"\n      }\n    ],\n    \"stateMutability\": \"view\",\n    \"type\": \"function\"\n  },\n  {\n    \"inputs\": [\n      {\n        \"internalType\": \"string\",\n        \"name\": \"\",\n        \"type\": \"string\"\n      }\n    ],\n    \"name\": \"products\",\n    \"outputs\": [\n      {\n        \"internalType\": \"uint256\",\n        \"name\": \"price\",\n        \"type\": \"uint256\"\n      },\n      {\n        \"internalType\": \"bool\",\n        \"name\": \"exists\",\n        \"type\": \"bool\"\n      }\n    ],\n    \"stateMutability\": \"view\",\n    \"type\": \"function\"\n\n    \n  }\n];\n\n\n\n\n        // Crée une nouvelle instance du contrat avec le provider\n      const contract = new ethers.Contract(contractAddress, contractABI, provider.getSigner());\n\n      // Appel direct à la méthode du contrat, sans attendre que contractInstance soit mis à jour\n      try {\n        const productDetails = await contract.products(\"product1\");\n        setProductInfo(productDetails);\n        setProductPrice(productDetails.price);\n      } catch (error) {\n        console.error(\"Erreur lors de la récupération des informations du produit:\", error);\n      }\n      \n      // Stocke cette instance dans l'état\n      setContractInstance(contract);\n    }\n  };\n\n  loadBlockchainData();\n  fetchBnbToUsdRate();\n}, [provider]);  // Dépendance sur 'provider' uniquement, pas besoin de contractInstance ici\n\n\n\n\n\n\n\n// Fonction pour approuver USDT (modifiée avec log)\nconst approveUSDT = async (amountToSend) => {\n  const signer = provider.getSigner();\n  const usdtContract = new ethers.Contract(usdtAddress, usdtABI, signer);\n\n  try {\n    const allowance = await usdtContract.allowance(await signer.getAddress(), contractAddress);\n    console.log(\"Allowance actuelle:\", allowance.toString());\n\n    if (allowance.lt(amountToSend)) {\n      console.log(\"Allowance insuffisante, approbation en cours...\");\n      const tx = await usdtContract.approve(contractAddress, amountToSend);\n      const receipt = await tx.wait();\n\n      if (receipt.status === 1) {\n        console.log(\"Allowance mise à jour !\");\n      } else {\n        console.error(\"L'approbation de l'allowance a échoué.\");\n        throw new Error(\"Échec de l'approbation de l'allowance.\");\n      }\n    } else {\n      console.log(\"Allowance suffisante.\");\n    }\n  } catch (error) {\n    console.error(\"Erreur lors de l'approbation de l'allowance USDT :\", error);\n  }\n};\n\n\n\n\n// Fonction pour vérifier l'allowance et l'approuver si nécessaire\nconst checkAllowance = async (amountToSend) => {\n  if (contractInstance) {\n    try {\n      const usdtContract = new ethers.Contract(usdtAddress, usdtABI, provider.getSigner());\n      const allowance = await usdtContract.allowance(walletAddress, contractAddress);\n      \n      console.log(\"Allowance:\", allowance.toString());\n\n      if (allowance.lt(amountToSend)) {\n        console.log(\"Allowance insuffisante. Approbation automatique...\");\n        \n        // Appel direct à la fonction approveUSDT pour approuver l'allowance nécessaire\n        await approveUSDT(amountToSend);\n      }\n    } catch (error) {\n      console.error(\"Erreur lors de la vérification de l'allowance:\", error);\n    }\n  }\n};\n\n\nconst payForProduct = async (productId, amount) => {\n  if (contractInstance) {\n    try {\n      // 1. Récupération du prix du produit\n      const price = fetchProductInfo(productId);\n      \n      // Vérifie si le prix est valide\n      if (price === null) {\n        console.error(\"Produit non trouvé ou prix invalide\");\n        alert(\"Le prix du produit est invalide.\");\n        return; // On arrête ici si le produit est invalide\n      }\n      \n      // 2. Si le prix est valide, on continue avec la transaction\n      console.log(\"Prix du produit récupéré:\", price);\n\n      const tx = await contractInstance.pay(usdtAddress, amount, productId, {\n        gasLimit: 200000,  // Ajuste selon les besoins\n      });\n      await tx.wait();  // Attends la confirmation de la transaction\n      console.log(\"Paiement effectué avec succès !\");\n    } catch (error) {\n      console.error(\"Erreur lors du paiement:\", error);\n      alert(\"Une erreur s'est produite lors du paiement.\");\n    }\n  }\n};\n\n\n\n\n  const [loading, setLoading] = useState(false); // Ajout de l'état loading\n  const [transactionInProgress, setTransactionInProgress] = useState(false);\n\n\n  const fetchProductInfo = (productId) => {\n    const localProducts = {\n      product1: { price: 5, exists: true, title: \"Indicateur Daily\" },\n      product2: { price: 295, exists: true, title: \"Indicateur 4h/1h\" },\n      product3: { price: 495, exists: true, title: \"Indicateur 15mn\" }\n    };\n    const product = localProducts[productId];\n    return product ? product.price : null; // Retourne null si le produit n'existe pas\n  };\n  \n  \n\n\n\n// Fonction conversion BNB/USDT\nconst getBnbToUsdRate = async () => {\n  try {\n    const response = await axios.get('https://api.coingecko.com/api/v3/simple/price?ids=binancecoin&vs_currencies=usd');\n    const bnbToUsdRate = response.data.binancecoin.usd;\n    if (bnbToUsdRate <= 0) {\n      throw new Error(\"Le taux de conversion BNB/USD est invalide.\");\n    }\n    return bnbToUsdRate;\n  } catch (error) {\n    console.error(\"Erreur lors de la récupération du taux de conversion BNB/USD :\", error);\n    return 0;\n  }\n};\n\n  \n  \n  \n  \n // Fonction de paiement avec gestion des prix et de l'allowance\nconst sendTransaction = async (amountIn, fetchedPriceInUsd) => {\n  if (!provider) {\n    alert(\"Le provider n'est pas défini, veuillez connecter votre wallet.\");\n    return;\n  }\n\n  try {\n    const signer = provider.getSigner();\n\n    // Convertir correctement le montant selon la devise\n    const amountToSend = selectedCurrency === 'USDT'\n      ? ethers.utils.parseUnits(amountIn.toString(), 6)  // USDT a 6 décimales\n      : ethers.utils.parseUnits(amountIn.toString(), 18); // BNB a 18 décimales\n\n    // Obtenir le gas price et l'ajuster\n    const gasLimit = 50000;\n    const gasPrice = await provider.getGasPrice();\n    const adjustedGasPrice = gasPrice.mul(110).div(100); // +10%\n\n    console.log(\"GasPrice ajusté : \", adjustedGasPrice.toString());\n\n    // Vérifier le solde pour BNB\n    const walletBalance = await provider.getBalance(signer.getAddress());\n    if (selectedCurrency === 'BNB' && walletBalance.lt(amountToSend.add(adjustedGasPrice))) {\n      alert(\"Solde insuffisant pour couvrir la transaction et les frais de gaz en BNB.\");\n      return;\n    }\n\n    // Vérifier le solde + allowance pour USDT\n    if (selectedCurrency === 'USDT') {\n      const usdtContract = new ethers.Contract(usdtAddress, usdtABI, signer);\n      const usdtBalance = await usdtContract.balanceOf(signer.getAddress());\n\n      if (usdtBalance.lt(amountToSend)) {\n        alert(\"Solde insuffisant en USDT pour couvrir la transaction.\");\n        return;\n      }\n\n      const allowance = await usdtContract.allowance(signer.getAddress(), contractAddress);\n      if (allowance.lt(amountToSend)) {\n        // Appel à la fonction approveUSDT si l'allowance est insuffisante\n        alert(\"Vous devez approuver le contrat pour utiliser vos USDT.\");\n        await approveUSDT(amountToSend); // Appel de la fonction approveUSDT pour donner l'allowance nécessaire\n      }\n    }\n\n    // Préparer la transaction\n    const tx = {\n      to: contractAddress,\n      value: selectedCurrency === 'BNB' ? amountToSend : 0,\n      gasLimit: gasLimit,\n      gasPrice: adjustedGasPrice,\n      data: ethers.utils.defaultAbiCoder.encode([\"uint256\"], [fetchedPriceInUsd]),\n    };\n\n    let transactionResponse;\n    if (selectedCurrency === 'USDT') {\n      const usdtContract = new ethers.Contract(usdtAddress, usdtABI, signer);\n      transactionResponse = await usdtContract.transferFrom(\n        signer.getAddress(),\n        contractAddress,\n        amountToSend\n      );\n      console.log(\"USDT envoyés au contrat.\");\n    } else {\n      transactionResponse = await signer.sendTransaction(tx);\n      console.log(\"Transaction envoyée:\", transactionResponse.hash);\n    }\n\n    const receipt = await transactionResponse.wait();\n    if (receipt.status === 1) {\n      console.log(\"Transaction réussie !\");\n      alert(\"Paiement effectué avec succès.\");\n      window.location.href = '/Delivrance_IndicateurD.html';\n    } else {\n      alert(\"Échec de la transaction.\");\n    }\n  } catch (error) {\n    console.error(\"Erreur lors de l'envoi de la transaction:\", error.message);\n    alert(\"Une erreur s'est produite lors de l'envoi de la transaction.\");\n  } finally {\n    console.log(\"Transaction terminée.\");\n  }\n};\n  \n  \n  \n  \n  \n  \n  \n\n\n  const checkNetwork = async () => {\n    if (typeof window.ethereum !== \"undefined\") {\n      const network = await window.ethereum.request({\n        method: 'eth_chainId'\n      });\n  \n      // Vérifie si l'utilisateur est bien sur BSC Testnet (chainId 97)\n      if (network !== '0x38') { // 0x38 est le chainId pour BSC Mainnet\n        alert(\"Veuillez vous connecter au réseau Binance Smart Chain Mainnet.\");\n        return false;\n      }\n      \n      return true;\n    } else {\n      console.error(\"Ethereum n'est pas disponible.\");\n      alert(\"MetaMask ou un autre portefeuille Ethereum n'est pas installé.\");\n      return false;\n    }\n  };\n\n\n\n\n\n\n  // Fonction pour réinitialiser le provider\n  const resetProvider = async () => {\n    try {\n      if (typeof window.ethereum !== \"undefined\") {\n        const newProvider = new ethers.providers.Web3Provider(window.ethereum);\n        setProvider(newProvider); // Mettre à jour le provider\n\n        // Attendre que React ait bien mis à jour le provider\n        return newProvider.getSigner(); // Retourner le signer après que le provider ait été mis à jour\n      } else {\n        throw new Error(\"Aucun fournisseur Ethereum n'est disponible.\");\n      }\n    } catch (error) {\n      console.error(\"Erreur dans resetProvider:\", error);\n      alert(\"Erreur lors de la réinitialisation du provider.\");\n      return null;\n    }\n  };\n\n  // Vérification du réseau à chaque fois qu'il change\n  useEffect(() => {\n    const changeNetworkHandler = async () => {\n      try {\n        await resetProvider(); // Remet à jour le provider lorsque le réseau change\n        console.log(\"Le provider a été réinitialisé après le changement de réseau.\");\n      } catch (error) {\n        console.error(\"Erreur lors du changement de réseau et réinitialisation du provider:\", error);\n      }\n    };\n\n    if (typeof window.ethereum !== \"undefined\") {\n      window.ethereum.on('chainChanged', changeNetworkHandler);\n    }\n\n    // Nettoyage quand le composant est démonté\n    return () => {\n      if (typeof window.ethereum !== \"undefined\") {\n        window.ethereum.removeListener('chainChanged', changeNetworkHandler);\n      }\n    };\n  }, []);\n  \n\n\n\n  const handlePayment = async () => {\n    if (loading || transactionInProgress) {\n      console.log(\"Transaction déjà en cours, veuillez patienter.\");\n      return; // Empêche l'exécution si une autre transaction est en cours\n    }\n    setTransactionInProgress(true); // Définir transactionInProgress à true avant de commencer\n    setLoading(true); // Empêche les clics multiples pendant le traitement\n    \n    // Vérifie que le prix est valide avant de procéder\n    if (convertedPrice === null || parseFloat(convertedPrice) <= 0) {\n      alert(\"Prix invalide ou non défini pour le produit.\");\n      setLoading(false);\n      setTransactionInProgress(false);\n      return;\n    }\n\n\n    if (!walletConnected) {\n      alert(\"Veuillez connecter votre wallet avant de procéder.\");\n      setLoading(false);  // Permet de déverrouiller le bouton si une erreur survient\n      setTransactionInProgress(false);  // Réinitialise l'état de la transaction\n      return;\n    }\n    \n    // Vérifie que le contrat est bien initialisé\n    if (!contractInstance) {\n      console.error(\"Le contrat n'est pas initialisé.\");\n      setLoading(false);\n      setTransactionInProgress(false);\n      return;\n    }\n\n    // Vérifie que le produit est bien sélectionné\n    if (!productId || !productInfo[productId]) {\n      alert(\"Veuillez sélectionner un produit valide et essayer de nouveau.\");\n      setLoading(false);\n      setTransactionInProgress(false);\n      return;\n    }\n\n    // Vérifie que l'utilisateur est sur le bon réseau\n    const isCorrectNetwork = await checkNetwork();\n    if (!isCorrectNetwork) {\n      setLoading(false);\n      setTransactionInProgress(false);\n      return;\n    }\n\n    // Vérifier que le provider est disponible\n    if (!provider) {\n      alert(\"Reconnexion au provider effectuée. Veuillez renouveler l'opération.\");\n      await resetProvider();\n      setLoading(false);\n      setTransactionInProgress(false);\n      return;\n    }\n      \n\n    // Récupération du prix en USD depuis IPFS\n    let fetchedPriceInUsd = await fetchProductInfo(productId);\n    if (fetchedPriceInUsd <= 0) {\n      alert(\"Le prix du produit est invalide.\");\n      setLoading(false);\n      setTransactionInProgress(false);\n      return;\n    }\n\n    console.log(\"Prix du produit en USD récupéré dans handlePayment:\", fetchedPriceInUsd);\n\n\n    // Récupération du taux de conversion BNB/USD\n    const bnbToUsdRate = await getBnbToUsdRate();\n    if (bnbToUsdRate <= 0) {\n      alert(\"Erreur de récupération du taux de conversion BNB/USD.\");\n      setLoading(false);\n      setTransactionInProgress(false);\n      return;\n    }\n\n    // Récupérer les détails du produit\n    const productDetails = productInfo[productId];\n\n    if (!productDetails || !productDetails.exists || productDetails.price <= 0) {\n      alert(\"Produit invalide ou prix incorrect.\");\n      setLoading(false);\n      setTransactionInProgress(false);\n      return;\n    }\n\n    // --- Ajout de la fonction pour récupérer le prix du produit ---\n    let amountIn = 0;\n    try {\n      // Utilisation directement de fetchedPriceInUsd\n      amountIn = fetchedPriceInUsd;\n\n      // Vérification de la devise et calcul du montant à envoyer\n      if (selectedCurrency === 'USDT') {\n        amountIn = fetchedPriceInUsd; // Utilise directement le prix en USD\n      } else if (selectedCurrency === 'BNB') {\n        amountIn = fetchedPriceInUsd / bnbToUsdRate; // Conversion de USD en BNB\n      } else {\n        alert(\"Devise non supportée pour ce paiement.\");\n        setLoading(false);\n        setTransactionInProgress(false);\n        return;\n      }\n\n      // Logs de vérification\n      console.log(\"Prix du produit en USD:\", fetchedPriceInUsd);\n      console.log(\"Taux de conversion BNB/USD:\", bnbToUsdRate);\n      console.log(\"Montant en BNB à envoyer:\", amountIn);\n\n      // Vérifier que amountIn est valide et non nul avant d'envoyer la transaction\n      if (parseFloat(amountIn) <= 0) {\n        alert(\"Le montant à payer est invalide (0 ou négatif).\");\n        setLoading(false);\n        setTransactionInProgress(false);\n        return;\n      }\n\n      // Convertir le montant à un format acceptable (fixé à 18 décimales)\n      amountIn = parseFloat(amountIn).toFixed(18);\n      console.log('Montant final pour la transaction:', amountIn);\n\n      // Envoyer la transaction\n      await checkAllowance(amountIn);  // Passe amountIn ici\n      await payForProduct(productId, amountIn);  // Passe amountIn ici\n\n      await sendTransaction(amountIn, fetchedPriceInUsd);\n\n      console.log(\"Transaction envoyée.\");\n\n    } catch (error) {\n      console.error(\"Erreur lors de l'envoi de la transaction:\", error.message);\n      alert(\"Une erreur s'est produite.\");\n    } finally {\n      setLoading(false);  // Permet de réactiver les interactions utilisateur\n      setTransactionInProgress(false);  // Mettre à jour l'état pour indiquer que la transaction est terminée\n    }\n  };\n\n  \n\n  \n  \n  // Mise à jour des informations du produit sélectionné\n  const updateProductInfo = useCallback((selectedProductId) => {\n    setProductId(selectedProductId);\n  \n    const productDetails = productInfo[selectedProductId];\n  \n    // Si le produit est trouvé et valide\n    if (productDetails && productDetails.exists && productDetails.price > 0) {\n      const price = productDetails.price;\n  \n      setProductPrice(price);\n  \n      setProductInfo(prevInfo => ({\n        ...prevInfo,\n        [selectedProductId]: { ...productDetails, price: price }\n      }));\n  \n      // Mettre à jour le prix converti en fonction de la devise sélectionnée\n      if (selectedCurrency === 'USDT') {\n        setConvertedPrice(price.toString()); // Le prix en USDT\n      } else if (selectedCurrency === 'BNB' && bnbToUsdRate > 0) {\n        setConvertedPrice((price / bnbToUsdRate).toString()); // Conversion en BNB\n      }\n    } else {\n      console.error(\"Produit invalide ou prix incorrect.\");\n      alert(\"Produit invalide ou prix incorrect.\");\n    }\n  }, [selectedCurrency, bnbToUsdRate]);\n  \n  \n\n// Utiliser useEffect pour mettre à jour le prix lorsque le produit ou la devise change\nuseEffect(() => {\n  // Si un produit est sélectionné\n  if (productId && productInfo[productId]) {\n    const productPrice = productInfo[productId].price;\n    \n    if (selectedCurrency === 'USDT') {\n      setConvertedPrice(productPrice.toString());\n    } else if (selectedCurrency === 'BNB' && bnbToUsdRate > 0) {\n      setConvertedPrice((productPrice / bnbToUsdRate).toString());\n    }\n  }\n}, [selectedCurrency, productId, bnbToUsdRate]);\n\n  \nconst handleCurrencyChange = (event) => {\n  setSelectedCurrency(event.target.value);\n  // Recalculer le prix converti en fonction de la devise sélectionnée\n  if (productId && productInfo[productId]) {\n    const productPrice = productInfo[productId].price;\n    \n    if (event.target.value === 'USDT') {\n      setConvertedPrice(productPrice.toString());\n    } else if (event.target.value === 'BNB' && bnbToUsdRate > 0) {\n      setConvertedPrice((productPrice / bnbToUsdRate).toString());\n    }\n  }\n};\n\n\n  \n  \n\n  return (\n    <div className=\"App\">\n      \n\n      {/* Contenu principal */}\n      <div className=\"parallax-container\">\n        <video id=\"video-background\" autoPlay loop muted>\n          {/* Remplace la source locale par l'URL IPFS */}\n          <source \n            src=\"https://gateway.pinata.cloud/ipfs/QmPZ8v3KzeyH2Dqz29TZFWe4kswkUETJyesZFCFULtagwv\" \n            type=\"video/mp4\" \n          />\n          Votre navigateur ne supporte pas les vidéos HTML5.\n        </video>\n\n        {/* Contenu défilant */}\n        <div className=\"content\">\n          \n\n          {/* Bouton de connexion du wallet en haut à droite */}\n          <div className=\"wallet-connect-button\">\n            <button\n      \n              onClick={connectWallet}\n              disabled={walletConnected} // Désactive le bouton une fois connecté\n            >\n              {walletConnected ? (\n                <>\n                  <span>Wallet connecté : {walletAddress}</span>\n                  <span className=\"arrow-icon\">→</span> {/* Icône flèche */}\n                </>\n              ) : (\n                'Connecter le wallet'\n              )}\n            </button>\n          </div>\n\n          {/* Conteneur du formulaire de paiement */}\n          <div className=\"payment-wrapper\">\n            <h1> Les Indicateurs à Levier </h1>\n\n            {productId && productInfo[productId] ? (\n              <>\n                <p>Produit choisi : {productInfo[productId].title}</p>\n                <p>Prix du produit : {convertedPrice !== null ? convertedPrice.toFixed(2) : \"Chargement...\"} {selectedCurrency}</p>\n\n                <p>Le produit est {productInfo[productId].exists ? 'disponible' : 'indisponible'}</p>\n              </>\n            ) : (\n              <p>Veuillez choisir un produit.</p>\n            )}\n\n            <select onChange={(e) => updateProductInfo(e.target.value)} value={productId}>\n              <option value=\"\">Choisi Ton Indicateur</option>\n              <option value=\"product1\">Indicateur Daily</option>\n              <option value=\"product2\">Indicateur 4h/1h</option>\n              <option value=\"product3\">Indicateur 15mn</option>\n              \n            </select>\n\n            <select onChange={handleCurrencyChange} value={selectedCurrency}>\n              <option value=\"USDT\">USD</option>\n              <option value=\"BNB\">BNB</option>\n            </select>\n\n            {/* Bouton de paiement */}\n            <button onClick={handlePayment} disabled={loading || transactionInProgress}>\n              {loading || transactionInProgress ? \"Paiement en cours...\" : \"Acheter\"}\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n\n  \n  \n};\n\n\nexport default App;\n\n\n\n\n\n\n","import React from 'react';\nimport ReactDOM from 'react-dom/client';  // Cette ligne doit être valide avec React 18\nimport App from './App';\nimport './index.css'; // Ajoute cette ligne dans ton fichier JavaScript\nimport './App.css'; \n\n\nconst root = ReactDOM.createRoot(document.getElementById('root'));\nroot.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>\n);\n"]}}